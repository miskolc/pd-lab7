<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- This file was created with the aha Ansi HTML Adapter. http://ziz.delphigl.com/tool_aha.php -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xml+xhtml; charset=UTF-8" />
<title>stdin</title>
</head>
<body>
<pre>
<span style="color:olive;">6940d60</span> Add Gitignore
<span style="color:olive;">413a409</span> Lab 7 - fix For program problem
<span style="color:olive;">8d86129</span> Laborator 7 adauga operatii + - * / si aproape tot For-ul
<span style="color:olive;">581801c</span> Add Subtraction
<span style="color:olive;">0791a85</span> Add Multiplication
<span style="color:olive;">ba6dc62</span> Fix indentation in lexer.mll
<span style="color:olive;">9d126e5</span> Initial commit
</pre>
</body>
</html>
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- This file was created with the aha Ansi HTML Adapter. http://ziz.delphigl.com/tool_aha.php -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xml+xhtml; charset=UTF-8" />
<title>stdin</title>
</head>
<body>
<pre>
<span style="color:olive;">commit 6940d60ec9b8034eeeae48b0299455db25c2a5da</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Fri Jan 9 10:32:16 2015 +0200

    Add Gitignore

<span style="font-weight:bold;">diff --git a/.gitignore b/.gitignore</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..e69de29</span>

<span style="color:olive;">commit 413a4098ccb9e294e9dbf0b3da4365df184b339b</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Wed Dec 10 00:38:29 2014 +0200

    Lab 7 - fix For program problem

<span style="font-weight:bold;">diff --git a/imp.cmi b/imp.cmi</span>
<span style="font-weight:bold;">index a6f38fe..7e0c29a 100644</span>
Binary files a/imp.cmi and b/imp.cmi differ
<span style="font-weight:bold;">diff --git a/imp.cmo b/imp.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..d68c05f</span>
Binary files /dev/null and b/imp.cmo differ
<span style="font-weight:bold;">diff --git a/imp.exe b/imp.exe</span>
<span style="font-weight:bold;">index acbb440..70d2510 100644</span>
Binary files a/imp.exe and b/imp.exe differ
<span style="font-weight:bold;">diff --git a/types.cmi b/types.cmi</span>
<span style="font-weight:bold;">index 0358691..6789ea1 100644</span>
Binary files a/types.cmi and b/types.cmi differ
<span style="font-weight:bold;">diff --git a/types.cmo b/types.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..321348f</span>
Binary files /dev/null and b/types.cmo differ
<span style="font-weight:bold;">diff --git a/types.ml b/types.ml</span>
<span style="font-weight:bold;">index 1775e5e..94b745d 100644</span>
<span style="font-weight:bold;">--- a/types.ml</span>
<span style="font-weight:bold;">+++ b/types.ml</span>
<span style="color:teal;">@@ -62,7 +62,7 @@</span> let rec infertype m = function
     | (TBool, t) -&gt; raise (TypeError (e2, TUnit, t))
     | (t,_) -&gt; raise (TypeError (e1, TBool, t)))
  | For (init, cond, incr, body, _) 
    -&gt; (match (infertype m init, infertype m cond, <span style="color:red;">inference</span><span style="color:green;">infertype</span> m incr, infertype m body) with
     | (TUnit, TBool, TUnit, TUnit) -&gt; TUnit
     | (TUnit, TBool, TUnit, t) -&gt; raise (TypeError (body, TUnit, t))
     | (TUnit, TBool, t, _) -&gt; raise (TypeError (incr, TUnit, t))

<span style="color:olive;">commit 8d86129152988e843ff16b8b3b3c85168d9983c7</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Wed Dec 10 00:23:36 2014 +0200

    Laborator 7 adauga operatii + - * / si aproape tot For-ul

<span style="font-weight:bold;">diff --git a/imp.cmi b/imp.cmi</span>
<span style="font-weight:bold;">index d5d2be1..a6f38fe 100644</span>
Binary files a/imp.cmi and b/imp.cmi differ
<span style="font-weight:bold;">diff --git a/imp.cmo b/imp.cmo</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index 32c102f..0000000</span>
Binary files a/imp.cmo and /dev/null differ
<span style="font-weight:bold;">diff --git a/imp.exe b/imp.exe</span>
<span style="font-weight:bold;">index 5c798d4..acbb440 100644</span>
Binary files a/imp.exe and b/imp.exe differ
<span style="font-weight:bold;">diff --git a/impAST.cmi b/impAST.cmi</span>
<span style="font-weight:bold;">index 3ef4820..0bd827d 100644</span>
Binary files a/impAST.cmi and b/impAST.cmi differ
<span style="font-weight:bold;">diff --git a/impAST.cmo b/impAST.cmo</span>
<span style="font-weight:bold;">index bb1fac7..e43e9f0 100644</span>
Binary files a/impAST.cmo and b/impAST.cmo differ
<span style="font-weight:bold;">diff --git a/impAST.ml b/impAST.ml</span>
<span style="font-weight:bold;">index 4a6e367..c1c1895 100644</span>
<span style="font-weight:bold;">--- a/impAST.ml</span>
<span style="font-weight:bold;">+++ b/impAST.ml</span>
<span style="color:teal;">@@ -4,12 +4,14 @@</span> type op =
  | Plus
  | Minus
  | Mult
  <span style="color:green;">| Div</span>
  | Mic

let string_of_op = function
  | Plus -&gt; &quot;+&quot;
  | Minus -&gt; &quot;-&quot;
  | Mult -&gt; &quot;*&quot;
  <span style="color:green;">| Div -&gt; &quot;/&quot;</span>
  | Mic -&gt; &quot;&lt;=&quot;

type expr =
<span style="color:teal;">@@ -21,6 +23,7 @@</span> type expr =
  | Secv of expr * expr * locatie
  | If of expr * expr * expr * locatie
  | While of expr * expr * locatie
  <span style="color:green;">| For of expr * expr * expr * expr * locatie</span>
  | Skip of locatie

let rec string_of_expr = function
<span style="color:teal;">@@ -35,6 +38,8 @@</span> let rec string_of_expr = function
    &quot;if &quot; ^ (string_of_expr e1) ^ &quot;\nthen &quot; ^ (string_of_expr e2) ^ &quot;\nelse (&quot; ^ (string_of_expr e3) ^ &quot;)&quot;
  | While (e1, e2,_) -&gt;
    &quot;while &quot; ^ (string_of_expr e1) ^ &quot; do \n&quot; ^ (string_of_expr e2) ^ &quot;\ndone&quot;
  <span style="color:green;">| For (e1, e2, e3, e4, _) -&gt; </span>
<span style="color:green;">    &quot;for (&quot; ^ (string_of_expr e1) ^ &quot;; &quot; ^ (string_of_expr e2) ^ &quot;; &quot; ^ (string_of_expr e3) ^ &quot;)\n (\n&quot; ^ (string_of_expr e4) ^ &quot;\n)&quot;</span>
  | Secv (e1,e2,_) -&gt;
    (string_of_expr e1) ^ &quot;;\n&quot; ^ (string_of_expr e2)
  | Skip _ -&gt; &quot;skip&quot;
<span style="color:teal;">@@ -48,6 +53,7 @@</span> let location = function
  | Atrib (_,_,l) -&gt; l
  | If (_, _, _,l) -&gt; l
  | While (_, _,l) -&gt; l
  <span style="color:green;">| For (_, _, _, _,l) -&gt; l</span>
  | Secv (_,_,l) -&gt; l
  | Skip l -&gt; l

<span style="color:teal;">@@ -69,6 +75,7 @@</span> let locations e =
          | Secv(e1,e2,_) -&gt; locations locs (e1::e2::exps)
          | If(e1,e2,e3,_) -&gt; locations locs (e1::e2::e3::exps)
          | While(e1,e2,_) -&gt; locations locs (e1::e2::exps)
          <span style="color:green;">| For(e1,e2,e3,e4,_) -&gt; locations locs (e1::e2::e3::e4::exps)</span>
      )
    in locations [] [e]

<span style="font-weight:bold;">diff --git a/lexer.cmi b/lexer.cmi</span>
<span style="font-weight:bold;">index 60aea48..ab11219 100644</span>
Binary files a/lexer.cmi and b/lexer.cmi differ
<span style="font-weight:bold;">diff --git a/lexer.cmo b/lexer.cmo</span>
<span style="font-weight:bold;">index 8fb286c..9e60cca 100644</span>
Binary files a/lexer.cmo and b/lexer.cmo differ
<span style="font-weight:bold;">diff --git a/lexer.ml b/lexer.ml</span>
<span style="font-weight:bold;">index a01645d..b0728bd 100644</span>
<span style="font-weight:bold;">--- a/lexer.ml</span>
<span style="font-weight:bold;">+++ b/lexer.ml</span>
<span style="color:teal;">@@ -33,6 +33,7 @@</span> let keyword_table = Hashtbl.create 20
   ( &quot;then&quot;         , THEN );
   ( &quot;else&quot;         , ELSE );
   ( &quot;while&quot;        , WHILE );
   <span style="color:green;">( &quot;for&quot;          , FOR );</span>
   ( &quot;do&quot;           , DO );
   ( &quot;done&quot;         , DONE );
   ( &quot;true&quot;         , TRUE );
<span style="color:teal;">@@ -40,29 +41,29 @@</span> let keyword_table = Hashtbl.create 20
   ( &quot;skip&quot;         , SKIP )]


# <span style="color:red;">44</span><span style="color:green;">45</span> &quot;lexer.ml&quot;
let __ocaml_lex_tables = {
  Lexing.lex_base = 
   <span style="color:red;">&quot;\000\000\241\255\242\255\075\000\244\255\245\255\000\000\247\255\</span>
<span style="color:red;">    \248\255\001\000\250\255\252\255\150\000\160\000\254\255\255\255\</span>
<span style="color:red;">    \249\255\246\255&quot;;</span><span style="color:green;">&quot;\000\000\240\255\241\255\075\000\243\255\244\255\000\000\246\255\</span>
<span style="color:green;">    \247\255\001\000\249\255\250\255\252\255\150\000\160\000\254\255\</span>
<span style="color:green;">    \255\255\248\255\245\255&quot;;</span>
  Lexing.lex_backtrk = 
   <span style="color:red;">&quot;\255\255\255\255\255\255\012\000\255\255\255\255\014\000\255\255\</span>
<span style="color:red;">    \255\255\014\000\255\255\255\255\002\000\004\000\255\255\255\255\</span>
<span style="color:red;">    \255\255\255\255&quot;;</span><span style="color:green;">&quot;\255\255\255\255\255\255\013\000\255\255\255\255\015\000\255\255\</span>
<span style="color:green;">    \255\255\015\000\255\255\255\255\255\255\002\000\004\000\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255&quot;;</span>
  Lexing.lex_default = 
   &quot;\001\000\000\000\000\000\255\255\000\000\000\000\255\255\000\000\
    <span style="color:red;">\000\000\255\255\000\000\000\000\255\255\255\255\000\000\000\000\</span>
<span style="color:red;">    \000\000\000\000&quot;;</span><span style="color:green;">\000\000\255\255\000\000\000\000\000\000\255\255\255\255\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000&quot;;</span>
  Lexing.lex_trans = 
   &quot;\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    <span style="color:red;">\000\000\014\000\015\000\000\000\000\000\014\000\000\000\000\000\</span><span style="color:green;">\000\000\015\000\016\000\000\000\000\000\015\000\000\000\000\000\</span>
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    <span style="color:red;">\014\000\004\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \008\000\007\000\010\000\011\000\000\000\013\000\000\000\000\000\</span>
<span style="color:red;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:red;">    \012\000\012\000\006\000\005\000\009\000\017\000\016\000\000\000\</span><span style="color:green;">\015\000\004\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \008\000\007\000\011\000\012\000\000\000\014\000\000\000\010\000\</span>
<span style="color:green;">    \013\000\013\000\013\000\013\000\013\000\013\000\013\000\013\000\</span>
<span style="color:green;">    \013\000\013\000\006\000\005\000\009\000\018\000\017\000\000\000\</span>
    \000\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
<span style="color:teal;">@@ -79,10 +80,10 @@</span> let __ocaml_lex_tables = {
    \000\000\000\000\003\000\000\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    <span style="color:red;">\003\000\003\000\003\000\003\000\003\000\003\000\012\000\012\000\</span>
<span style="color:red;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:red;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:red;">    \012\000\012\000\000\000\000\000\000\000\000\000\000\000\000\000\</span><span style="color:green;">\003\000\003\000\003\000\003\000\003\000\003\000\013\000\013\000\</span>
<span style="color:green;">    \013\000\013\000\013\000\013\000\013\000\013\000\013\000\013\000\</span>
<span style="color:green;">    \013\000\013\000\013\000\013\000\013\000\013\000\013\000\013\000\</span>
<span style="color:green;">    \013\000\013\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
<span style="color:teal;">@@ -114,7 +115,7 @@</span> let __ocaml_lex_tables = {
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \000\000\000\000\255\255\255\255\255\255\255\255\255\255\255\255\
    <span style="color:red;">\000\000\000\000\000\000\000\000\255\255\000\000\255\255\255\255\</span><span style="color:green;">\000\000\000\000\000\000\000\000\255\255\000\000\255\255\000\000\</span>
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\006\000\009\000\255\255\
    \255\255\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
<span style="color:teal;">@@ -133,10 +134,10 @@</span> let __ocaml_lex_tables = {
    \255\255\255\255\003\000\255\255\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    <span style="color:red;">\003\000\003\000\003\000\003\000\003\000\003\000\012\000\012\000\</span>
<span style="color:red;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span><span style="color:green;">\003\000\003\000\003\000\003\000\003\000\003\000\013\000\013\000\</span>
    \013\000\013\000\013\000\013\000\013\000\013\000\013\000\013\000\
    <span style="color:red;">\013\000\013\000\255\255\255\255\255\255\255\255\255\255\255\255\</span><span style="color:green;">\014\000\014\000\014\000\014\000\014\000\014\000\014\000\014\000\</span>
<span style="color:green;">    \014\000\014\000\255\255\255\255\255\255\255\255\255\255\255\255\</span>
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
<span style="color:teal;">@@ -181,90 +182,95 @@</span> let rec token lexbuf =
and __ocaml_lex_token_rec lexbuf __ocaml_lex_state =
  match Lexing.engine __ocaml_lex_tables __ocaml_lex_state lexbuf with
      | 0 -&gt;
# <span style="color:red;">45</span><span style="color:green;">46</span> &quot;lexer.mll&quot;
             ( incr_linenum lexbuf ; token lexbuf )
# <span style="color:red;">187</span><span style="color:green;">188</span> &quot;lexer.ml&quot;

  | 1 -&gt;
# <span style="color:red;">46</span><span style="color:green;">47</span> &quot;lexer.mll&quot;
                         ( token lexbuf )
# <span style="color:red;">192</span><span style="color:green;">193</span> &quot;lexer.ml&quot;

  | 2 -&gt;
let
# <span style="color:red;">47</span><span style="color:green;">48</span> &quot;lexer.mll&quot;
                        lxm
# <span style="color:red;">198</span><span style="color:green;">199</span> &quot;lexer.ml&quot;
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# <span style="color:red;">47</span><span style="color:green;">48</span> &quot;lexer.mll&quot;
                            ( INT(int_of_string lxm) )
# <span style="color:red;">202</span><span style="color:green;">203</span> &quot;lexer.ml&quot;

  | 3 -&gt;
# <span style="color:red;">48</span><span style="color:green;">49</span> &quot;lexer.mll&quot;
                   ( PLUS )
# <span style="color:red;">207</span><span style="color:green;">208</span> &quot;lexer.ml&quot;

  | 4 -&gt;
# <span style="color:red;">49</span><span style="color:green;">50</span> &quot;lexer.mll&quot;
                   ( MINUS )
# <span style="color:red;">212</span><span style="color:green;">213</span> &quot;lexer.ml&quot;

  | 5 -&gt;
# <span style="color:red;">50</span><span style="color:green;">51</span> &quot;lexer.mll&quot;
                   ( MULT )
# <span style="color:red;">217</span><span style="color:green;">218</span> &quot;lexer.ml&quot;

  | 6 -&gt;
# <span style="color:red;">51</span><span style="color:green;">52</span> &quot;lexer.mll&quot;
                   ( <span style="color:red;">LTE</span><span style="color:green;">DIV</span> )
# <span style="color:red;">222</span><span style="color:green;">223</span> &quot;lexer.ml&quot;

  | 7 -&gt;
# <span style="color:red;">52</span><span style="color:green;">53</span> &quot;lexer.mll&quot;
                   ( <span style="color:red;">LPAREN</span><span style="color:green;">LTE</span> )
# <span style="color:red;">227</span><span style="color:green;">228</span> &quot;lexer.ml&quot;

  | 8 -&gt;
# <span style="color:red;">53</span><span style="color:green;">54</span> &quot;lexer.mll&quot;
                   ( <span style="color:red;">RPAREN</span><span style="color:green;">LPAREN</span> )
# <span style="color:red;">232</span><span style="color:green;">233</span> &quot;lexer.ml&quot;

  | 9 -&gt;
# <span style="color:red;">54</span><span style="color:green;">55</span> &quot;lexer.mll&quot;
                   ( <span style="color:red;">ASGNOP</span><span style="color:green;">RPAREN</span> )
# <span style="color:red;">237</span><span style="color:green;">238</span> &quot;lexer.ml&quot;

  | 10 -&gt;
# <span style="color:red;">55</span><span style="color:green;">56</span> &quot;lexer.mll&quot;
                   ( <span style="color:red;">SEQ</span><span style="color:green;">ASGNOP</span> )
# <span style="color:red;">242</span><span style="color:green;">243</span> &quot;lexer.ml&quot;

  | 11 -&gt;
# <span style="color:red;">56</span><span style="color:green;">57</span> &quot;lexer.mll&quot;
                   ( <span style="color:red;">DEREF</span><span style="color:green;">SEQ</span> )
# <span style="color:red;">247</span><span style="color:green;">248</span> &quot;lexer.ml&quot;

  | 12 -&gt;
<span style="color:green;"># 58 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( DEREF )</span>
<span style="color:green;"># 253 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 13 -&gt;</span>
let
# <span style="color:red;">57</span><span style="color:green;">59</span> &quot;lexer.mll&quot;
                                                         id
# <span style="color:red;">253</span><span style="color:green;">259</span> &quot;lexer.ml&quot;
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# <span style="color:red;">58</span><span style="color:green;">60</span> &quot;lexer.mll&quot;
                   ( try Hashtbl.find keyword_table id 
                     with Not_found -&gt; LOC(id))
# <span style="color:red;">258</span><span style="color:green;">264</span> &quot;lexer.ml&quot;

  | <span style="color:red;">13</span><span style="color:green;">14</span> -&gt;
# <span style="color:red;">60</span><span style="color:green;">62</span> &quot;lexer.mll&quot;
                   ( EOF )
# <span style="color:red;">263</span><span style="color:green;">269</span> &quot;lexer.ml&quot;

  | <span style="color:red;">14</span><span style="color:green;">15</span> -&gt;
# <span style="color:red;">61</span><span style="color:green;">63</span> &quot;lexer.mll&quot;
                   ( lex_error lexbuf )
# <span style="color:red;">268</span><span style="color:green;">274</span> &quot;lexer.ml&quot;

  | __ocaml_lex_state -&gt; lexbuf.Lexing.refill_buff lexbuf; __ocaml_lex_token_rec lexbuf __ocaml_lex_state

<span style="font-weight:bold;">diff --git a/lexer.mll b/lexer.mll</span>
<span style="font-weight:bold;">index 8009d40..9d01437 100644</span>
<span style="font-weight:bold;">--- a/lexer.mll</span>
<span style="font-weight:bold;">+++ b/lexer.mll</span>
<span style="color:teal;">@@ -33,6 +33,7 @@</span> let keyword_table = Hashtbl.create 20
   ( &quot;then&quot;         , THEN );
   ( &quot;else&quot;         , ELSE );
   ( &quot;while&quot;        , WHILE );
   <span style="color:green;">( &quot;for&quot;          , FOR );</span>
   ( &quot;do&quot;           , DO );
   ( &quot;done&quot;         , DONE );
   ( &quot;true&quot;         , TRUE );
<span style="color:teal;">@@ -48,6 +49,7 @@</span> rule token = parse
  | '+'            { PLUS }
  | '-'            { MINUS }
  | '*'            { MULT }
  <span style="color:green;">| '/'            { DIV }</span>
  | &quot;&lt;=&quot;           { LTE }
  | '('            { LPAREN }
  | ')'            { RPAREN }
<span style="font-weight:bold;">diff --git a/parser.cmi b/parser.cmi</span>
<span style="font-weight:bold;">index e3a3edd..154dcf0 100644</span>
Binary files a/parser.cmi and b/parser.cmi differ
<span style="font-weight:bold;">diff --git a/parser.cmo b/parser.cmo</span>
<span style="font-weight:bold;">index 04e8247..fdbb93d 100644</span>
Binary files a/parser.cmo and b/parser.cmo differ
<span style="font-weight:bold;">diff --git a/parser.ml b/parser.ml</span>
<span style="font-weight:bold;">index e2dc253..8a4ccf5 100644</span>
<span style="font-weight:bold;">--- a/parser.ml</span>
<span style="font-weight:bold;">+++ b/parser.ml</span>
<span style="color:teal;">@@ -11,12 +11,14 @@</span> type token =
  | WHILE
  | DO
  | DONE
  <span style="color:green;">| FOR</span>
  | LTE
  | ASGNOP
  | DEREF
  | PLUS
  | MINUS
  | MULT
  <span style="color:green;">| DIV</span>
  | LPAREN
  | RPAREN
  | EOF
<span style="color:teal;">@@ -36,7 +38,7 @@</span> let location () =  let start_pos = Parsing.symbol_start_pos () in

let parseError loc = raise (Lexer.ParseError loc)

# <span style="color:red;">40</span><span style="color:green;">42</span> &quot;parser.ml&quot;
let yytransl_const = [|
  259 (* TRUE *);
  260 (* FALSE *);
<span style="color:teal;">@@ -48,14 +50,16 @@</span> let yytransl_const = [|
  266 (* WHILE *);
  267 (* DO *);
  268 (* DONE *);
  269 (* <span style="color:red;">LTE</span><span style="color:green;">FOR</span> *);
  270 (* <span style="color:red;">ASGNOP</span><span style="color:green;">LTE</span> *);
  271 (* <span style="color:red;">DEREF</span><span style="color:green;">ASGNOP</span> *);
  272 (* <span style="color:red;">PLUS</span><span style="color:green;">DEREF</span> *);
  273 (* <span style="color:red;">MINUS</span><span style="color:green;">PLUS</span> *);
  274 (* <span style="color:red;">MULT</span><span style="color:green;">MINUS</span> *);
  275 (* <span style="color:red;">LPAREN</span><span style="color:green;">MULT</span> *);
  276 (* <span style="color:green;">DIV *);</span>
<span style="color:green;">  277 (* LPAREN *);</span>
<span style="color:green;">  278 (*</span> RPAREN *);
    0 (* EOF *);
    0|]

<span style="color:teal;">@@ -67,55 +71,67 @@</span> let yytransl_block = [|
let yylhs = &quot;\255\255\
\001\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
\002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
<span style="color:red;">\000\000&quot;</span><span style="color:green;">\002\000\002\000\000\000&quot;</span>

let yylen = &quot;\002\000\
\002\000\001\000\001\000\001\000\001\000\003\000\003\000\003\000\
<span style="color:red;">\003\000\002\000\003\000\003\000\003\000\006\000\005\000\001\000\</span>
<span style="color:red;">\002\000&quot;</span><span style="color:green;">\003\000\003\000\002\000\003\000\003\000\003\000\006\000\005\000\</span>
<span style="color:green;">\009\000\001\000\002\000&quot;</span>

let yydefred = &quot;\000\000\
<span style="color:red;">\000\000\000\000\016\000\002\000\000\000\003\000\004\000\005\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\017\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\010\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\001\000\000\000\000\000\000\000\006\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\009\000\000\000\000\000\000\000\015\000\000\000&quot;</span><span style="color:green;">\000\000\000\000\018\000\002\000\000\000\003\000\004\000\005\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\019\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\011\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\001\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\006\000\000\000\000\000\000\000\000\000\000\000\010\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\016\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000&quot;</span>

let yydgoto = &quot;\002\000\
<span style="color:red;">\013\000\014\000&quot;</span><span style="color:green;">\014\000\015\000&quot;</span>

let yysindex = &quot;\255\255\
<span style="color:red;">\044\255\000\000\000\000\000\000\248\254\000\000\000\000\000\000\</span>
<span style="color:red;">\044\255\044\255\006\255\044\255\000\000\049\000\044\255\048\255\</span>
<span style="color:red;">\057\255\000\000\022\255\044\255\044\255\044\255\044\255\044\255\</span>
<span style="color:red;">\000\000\008\255\044\255\044\255\000\000\083\255\008\255\241\254\</span>
<span style="color:red;">\002\255\000\000\067\255\074\255\044\255\000\000\252\254&quot;</span><span style="color:green;">\072\255\000\000\000\000\000\000\247\254\000\000\000\000\000\000\</span>
<span style="color:green;">\072\255\072\255\242\254\007\255\072\255\000\000\086\000\072\255\</span>
<span style="color:green;">\047\255\078\255\072\255\000\000\010\255\072\255\072\255\072\255\</span>
<span style="color:green;">\072\255\072\255\072\255\000\000\039\255\072\255\072\255\103\255\</span>
<span style="color:green;">\000\000\111\255\039\255\015\255\239\254\246\254\000\000\085\255\</span>
<span style="color:green;">\095\255\072\255\072\255\000\000\119\255\126\255\072\255\031\255\</span>
<span style="color:green;">\072\255\126\255&quot;</span>

let yyrindex = &quot;\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
<span style="color:red;">\000\000\021\000\000\000\000\000\000\000\036\000\031\000\011\000\</span>
<span style="color:red;">\001\000\000\000\000\000\000\000\000\000\000\000\041\000&quot;</span><span style="color:green;">\000\000\000\000\000\000\000\000\046\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\077\000\054\000\031\000\016\000\001\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\062\000\000\000\000\000\</span>
<span style="color:green;">\000\000\070\000&quot;</span>

let yygindex = &quot;\000\000\
\000\000\251\255&quot;

let yytablesize = <span style="color:red;">323</span><span style="color:green;">362</span>
let yytable = &quot;\001\000\
<span style="color:red;">\008\000\023\000\024\000\016\000\017\000\015\000\019\000\018\000\</span>
<span style="color:red;">\021\000\026\000\007\000\022\000\023\000\024\000\030\000\031\000\</span>
<span style="color:red;">\032\000\033\000\034\000\024\000\011\000\035\000\036\000\022\000\</span>
<span style="color:red;">\023\000\024\000\020\000\000\000\000\000\000\000\012\000\039\000\</span>
<span style="color:red;">\000\000\000\000\021\000\013\000\000\000\022\000\023\000\024\000\</span>
<span style="color:red;">\014\000\029\000\000\000\003\000\004\000\005\000\006\000\007\000\</span>
<span style="color:red;">\025\000\008\000\009\000\000\000\020\000\010\000\000\000\027\000\</span>
<span style="color:red;">\000\000\000\000\011\000\000\000\021\000\020\000\012\000\022\000\</span>
<span style="color:red;">\023\000\024\000\000\000\028\000\000\000\021\000\000\000\020\000\</span>
<span style="color:red;">\022\000\023\000\024\000\037\000\000\000\000\000\020\000\021\000\</span>
<span style="color:red;">\000\000\000\000\022\000\023\000\024\000\038\000\021\000\020\000\</span>
<span style="color:red;">\000\000\022\000\023\000\024\000\000\000\000\000\000\000\021\000\</span>
<span style="color:red;">\000\000\000\000\022\000\023\000\024\000\000\000\000\000\000\000\</span><span style="color:green;">\009\000\026\000\027\000\017\000\018\000\016\000\019\000\021\000\</span>
<span style="color:green;">\020\000\027\000\029\000\000\000\000\000\032\000\022\000\008\000\</span>
<span style="color:green;">\034\000\035\000\036\000\037\000\038\000\039\000\000\000\023\000\</span>
<span style="color:green;">\040\000\041\000\024\000\025\000\026\000\027\000\007\000\033\000\</span>
<span style="color:green;">\025\000\026\000\027\000\022\000\045\000\046\000\000\000\000\000\</span>
<span style="color:green;">\000\000\048\000\000\000\050\000\023\000\012\000\000\000\024\000\</span>
<span style="color:green;">\025\000\026\000\027\000\022\000\049\000\013\000\030\000\024\000\</span>
<span style="color:green;">\025\000\026\000\027\000\000\000\023\000\015\000\000\000\024\000\</span>
<span style="color:green;">\025\000\026\000\027\000\000\000\000\000\017\000\000\000\003\000\</span>
<span style="color:green;">\004\000\005\000\006\000\007\000\014\000\008\000\009\000\000\000\</span>
<span style="color:green;">\000\000\010\000\022\000\000\000\011\000\028\000\000\000\012\000\</span>
<span style="color:green;">\031\000\022\000\000\000\023\000\013\000\043\000\024\000\025\000\</span>
<span style="color:green;">\026\000\027\000\023\000\022\000\000\000\024\000\025\000\026\000\</span>
<span style="color:green;">\027\000\000\000\044\000\042\000\023\000\000\000\000\000\024\000\</span>
<span style="color:green;">\025\000\026\000\027\000\022\000\023\000\000\000\000\000\024\000\</span>
<span style="color:green;">\025\000\026\000\027\000\047\000\023\000\000\000\000\000\024\000\</span>
<span style="color:green;">\025\000\026\000\027\000\000\000\023\000\000\000\000\000\024\000\</span>
<span style="color:green;">\025\000\026\000\027\000\023\000\000\000\000\000\024\000\025\000\</span>
<span style="color:green;">\026\000\027\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
<span style="color:teal;">@@ -129,42 +145,41 @@</span> let yytable = &quot;\001\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\008\000\000\000\000\000\</span>
<span style="color:red;">\008\000\008\000\000\000\008\000\008\000\008\000\000\000\007\000\</span>
<span style="color:red;">\008\000\008\000\007\000\007\000\008\000\007\000\007\000\007\000\</span>
<span style="color:red;">\000\000\011\000\007\000\000\000\011\000\011\000\007\000\011\000\</span>
<span style="color:red;">\011\000\011\000\000\000\012\000\000\000\000\000\012\000\012\000\</span>
<span style="color:red;">\011\000\012\000\012\000\013\000\013\000\014\000\013\000\013\000\</span>
<span style="color:red;">\014\000\014\000\012\000\014\000\014\000\020\000\000\000\013\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\014\000\021\000\000\000\000\000\</span>
<span style="color:red;">\022\000\023\000\024\000&quot;</span><span style="color:green;">\000\000\000\000\000\000\000\000\000\000\009\000\000\000\000\000\</span>
<span style="color:green;">\009\000\009\000\000\000\009\000\009\000\000\000\009\000\000\000\</span>
<span style="color:green;">\000\000\009\000\009\000\009\000\008\000\000\000\009\000\008\000\</span>
<span style="color:green;">\008\000\000\000\008\000\008\000\000\000\008\000\000\000\000\000\</span>
<span style="color:green;">\008\000\008\000\000\000\007\000\000\000\008\000\007\000\007\000\</span>
<span style="color:green;">\000\000\007\000\007\000\000\000\007\000\000\000\000\000\007\000\</span>
<span style="color:green;">\000\000\000\000\012\000\000\000\007\000\012\000\012\000\000\000\</span>
<span style="color:green;">\012\000\012\000\013\000\012\000\000\000\013\000\013\000\000\000\</span>
<span style="color:green;">\013\000\013\000\015\000\012\000\000\000\015\000\015\000\000\000\</span>
<span style="color:green;">\015\000\015\000\017\000\013\000\000\000\017\000\017\000\000\000\</span>
<span style="color:green;">\017\000\017\000\000\000\015\000\014\000\014\000\000\000\014\000\</span>
<span style="color:green;">\014\000\000\000\022\000\017\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\014\000\023\000\000\000\000\000\024\000\025\000\</span>
<span style="color:green;">\026\000\027\000&quot;</span>

let yycheck = &quot;\001\000\
<span style="color:red;">\000\000\017\001\018\001\009\000\010\000\014\001\012\000\002\001\</span>
<span style="color:red;">\013\001\015\000\000\000\016\001\017\001\018\001\020\000\021\000\</span>
<span style="color:red;">\022\000\023\000\024\000\018\001\000\000\027\000\028\000\016\001\</span>
<span style="color:red;">\017\001\018\001\005\001\255\255\255\255\255\255\000\000\037\000\</span>
<span style="color:red;">\255\255\255\255\013\001\000\000\255\255\016\001\017\001\018\001\</span>
<span style="color:red;">\000\000\020\001\255\255\000\001\001\001\002\001\003\001\004\001\</span>
<span style="color:red;">\000\000\006\001\007\001\255\255\005\001\010\001\255\255\008\001\</span>
<span style="color:red;">\255\255\255\255\015\001\255\255\013\001\005\001\019\001\016\001\</span>
<span style="color:red;">\017\001\018\001\255\255\011\001\255\255\013\001\255\255\005\001\</span>
<span style="color:red;">\016\001\017\001\018\001\009\001\255\255\255\255\005\001\013\001\</span>
<span style="color:red;">\255\255\255\255\016\001\017\001\018\001\012\001\013\001\005\001\</span>
<span style="color:red;">\255\255\016\001\017\001\018\001\255\255\255\255\255\255\013\001\</span>
<span style="color:red;">\255\255\255\255\016\001\017\001\018\001\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span><span style="color:green;">\000\000\019\001\020\001\009\000\010\000\015\001\021\001\013\000\</span>
<span style="color:green;">\002\001\020\001\016\000\255\255\255\255\019\000\005\001\000\000\</span>
<span style="color:green;">\022\000\023\000\024\000\025\000\026\000\027\000\255\255\014\001\</span>
<span style="color:green;">\030\000\031\000\017\001\018\001\019\001\020\001\000\000\022\001\</span>
<span style="color:green;">\018\001\019\001\020\001\005\001\042\000\043\000\255\255\255\255\</span>
<span style="color:green;">\255\255\047\000\255\255\049\000\014\001\000\000\255\255\017\001\</span>
<span style="color:green;">\018\001\019\001\020\001\005\001\022\001\000\000\008\001\017\001\</span>
<span style="color:green;">\018\001\019\001\020\001\255\255\014\001\000\000\255\255\017\001\</span>
<span style="color:green;">\018\001\019\001\020\001\255\255\255\255\000\000\255\255\000\001\</span>
<span style="color:green;">\001\001\002\001\003\001\004\001\000\000\006\001\007\001\255\255\</span>
<span style="color:green;">\255\255\010\001\005\001\255\255\013\001\000\000\255\255\016\001\</span>
<span style="color:green;">\011\001\005\001\255\255\014\001\021\001\009\001\017\001\018\001\</span>
<span style="color:green;">\019\001\020\001\014\001\005\001\255\255\017\001\018\001\019\001\</span>
<span style="color:green;">\020\001\255\255\012\001\005\001\014\001\255\255\255\255\017\001\</span>
<span style="color:green;">\018\001\019\001\020\001\005\001\014\001\255\255\255\255\017\001\</span>
<span style="color:green;">\018\001\019\001\020\001\005\001\014\001\255\255\255\255\017\001\</span>
<span style="color:green;">\018\001\019\001\020\001\255\255\014\001\255\255\255\255\017\001\</span>
<span style="color:green;">\018\001\019\001\020\001\014\001\255\255\255\255\017\001\018\001\</span>
<span style="color:green;">\019\001\020\001\255\255\255\255\255\255\255\255\255\255\255\255\</span>
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
<span style="color:teal;">@@ -179,14 +194,19 @@</span> let yycheck = &quot;\001\000\
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
\255\255\255\255\255\255\255\255\255\255\005\001\255\255\255\255\
<span style="color:red;">\008\001\009\001\255\255\011\001\012\001\013\001\255\255\005\001\</span>
<span style="color:red;">\016\001\017\001\008\001\009\001\020\001\011\001\012\001\013\001\</span>
<span style="color:red;">\255\255\005\001\016\001\255\255\008\001\009\001\020\001\011\001\</span>
<span style="color:red;">\012\001\013\001\255\255\005\001\255\255\255\255\008\001\009\001\</span>
<span style="color:red;">\020\001\011\001\012\001\008\001\009\001\005\001\011\001\012\001\</span>
<span style="color:red;">\008\001\009\001\020\001\011\001\012\001\005\001\255\255\020\001\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\020\001\013\001\255\255\255\255\</span>
<span style="color:red;">\016\001\017\001\018\001&quot;</span><span style="color:green;">\008\001\009\001\255\255\011\001\012\001\255\255\014\001\255\255\</span>
<span style="color:green;">\255\255\017\001\018\001\019\001\005\001\255\255\022\001\008\001\</span>
<span style="color:green;">\009\001\255\255\011\001\012\001\255\255\014\001\255\255\255\255\</span>
<span style="color:green;">\017\001\018\001\255\255\005\001\255\255\022\001\008\001\009\001\</span>
<span style="color:green;">\255\255\011\001\012\001\255\255\014\001\255\255\255\255\017\001\</span>
<span style="color:green;">\255\255\255\255\005\001\255\255\022\001\008\001\009\001\255\255\</span>
<span style="color:green;">\011\001\012\001\005\001\014\001\255\255\008\001\009\001\255\255\</span>
<span style="color:green;">\011\001\012\001\005\001\022\001\255\255\008\001\009\001\255\255\</span>
<span style="color:green;">\011\001\012\001\005\001\022\001\255\255\008\001\009\001\255\255\</span>
<span style="color:green;">\011\001\012\001\255\255\022\001\008\001\009\001\255\255\011\001\</span>
<span style="color:green;">\012\001\255\255\005\001\022\001\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\022\001\014\001\255\255\255\255\017\001\018\001\</span>
<span style="color:green;">\019\001\020\001&quot;</span>

let yynames_const = &quot;\
  TRUE\000\
<span style="color:teal;">@@ -199,12 +219,14 @@</span> let yynames_const = &quot;\
  WHILE\000\
  DO\000\
  DONE\000\
  <span style="color:green;">FOR\000\</span>
  LTE\000\
  ASGNOP\000\
  DEREF\000\
  PLUS\000\
  MINUS\000\
  MULT\000\
  <span style="color:green;">DIV\000\</span>
  LPAREN\000\
  RPAREN\000\
  EOF\000\
<span style="color:teal;">@@ -220,119 +242,137 @@</span> let yyact = [|
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in
    Obj.repr(
# <span style="color:red;">41</span><span style="color:green;">45</span> &quot;parser.mly&quot;
                            ( _1 )
# <span style="color:red;">226</span><span style="color:green;">248</span> &quot;parser.ml&quot;
               : ImpAST.expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 0 : int) in
    Obj.repr(
# <span style="color:red;">44</span><span style="color:green;">48</span> &quot;parser.mly&quot;
                               ( Int (_1,location()) )
# <span style="color:red;">233</span><span style="color:green;">255</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    Obj.repr(
# <span style="color:red;">45</span><span style="color:green;">49</span> &quot;parser.mly&quot;
                               ( Bool (true, location()) )
# <span style="color:red;">239</span><span style="color:green;">261</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    Obj.repr(
# <span style="color:red;">46</span><span style="color:green;">50</span> &quot;parser.mly&quot;
                               ( Bool (false, location()) )
# <span style="color:red;">245</span><span style="color:green;">267</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    Obj.repr(
# <span style="color:red;">47</span><span style="color:green;">51</span> &quot;parser.mly&quot;
                               ( Skip (location()) )
# <span style="color:red;">251</span><span style="color:green;">273</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _2 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in
    Obj.repr(
# <span style="color:red;">48</span><span style="color:green;">52</span> &quot;parser.mly&quot;
                               ( _2 )
# <span style="color:red;">258</span><span style="color:green;">280</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">49</span><span style="color:green;">53</span> &quot;parser.mly&quot;
                               ( Op (_1,Plus,_3, location()) )
# <span style="color:red;">266</span><span style="color:green;">288</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">50</span><span style="color:green;">54</span> &quot;parser.mly&quot;
                               ( Op (_1,Minus,_3, location()) )
# <span style="color:red;">274</span><span style="color:green;">296</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">51</span><span style="color:green;">55</span> &quot;parser.mly&quot;
                               ( Op (_1,Mult,_3, location()) )
# <span style="color:red;">282</span><span style="color:green;">304 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 56 &quot;parser.mly&quot;</span>
<span style="color:green;">                              ( Op (_1,Div,_3, location()) )</span>
<span style="color:green;"># 312</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _2 = (Parsing.peek_val __caml_parser_env 0 : string) in
    Obj.repr(
# <span style="color:red;">52</span><span style="color:green;">57</span> &quot;parser.mly&quot;
                               ( Loc (_2, location()) )
# <span style="color:red;">289</span><span style="color:green;">319</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : string) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">53</span><span style="color:green;">58</span> &quot;parser.mly&quot;
                               ( Atrib (_1,_3, location()) )
# <span style="color:red;">297</span><span style="color:green;">327</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">54</span><span style="color:green;">59</span> &quot;parser.mly&quot;
                               ( Op (_1, Mic, _3, location()) )
# <span style="color:red;">305</span><span style="color:green;">335</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">55</span><span style="color:green;">60</span> &quot;parser.mly&quot;
                               ( Secv (_1,_3, location()) )
# <span style="color:red;">313</span><span style="color:green;">343</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _2 = (Parsing.peek_val __caml_parser_env 4 : 'expr) in
    let _4 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _6 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">57</span><span style="color:green;">62</span> &quot;parser.mly&quot;
                               ( If (_2, _4, _6, location()) )
# <span style="color:red;">322</span><span style="color:green;">352</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _2 = (Parsing.peek_val __caml_parser_env 3 : 'expr) in
    let _4 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in
    Obj.repr(
# <span style="color:red;">58</span><span style="color:green;">63</span> &quot;parser.mly&quot;
                               ( While (_2, _4, location()) )
# <span style="color:red;">330</span><span style="color:green;">360</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    <span style="color:green;">let _3 = (Parsing.peek_val __caml_parser_env 6 : 'expr) in</span>
<span style="color:green;">    let _5 = (Parsing.peek_val __caml_parser_env 4 : 'expr) in</span>
<span style="color:green;">    let _7 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _9 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
    Obj.repr(
# <span style="color:red;">59</span><span style="color:green;">65 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( For (_3, _5, _7, _9, location()) )</span>
<span style="color:green;"># 370 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 66</span> &quot;parser.mly&quot;
                               ( parseError (location ()) )
# <span style="color:red;">336</span><span style="color:green;">376</span> &quot;parser.ml&quot;
               : 'expr))
(* Entry main *)
; (fun __caml_parser_env -&gt; raise (Parsing.YYexit (Parsing.peek_val __caml_parser_env 0)))
<span style="font-weight:bold;">diff --git a/parser.mli b/parser.mli</span>
<span style="font-weight:bold;">index fcebdd6..bccf445 100644</span>
<span style="font-weight:bold;">--- a/parser.mli</span>
<span style="font-weight:bold;">+++ b/parser.mli</span>
<span style="color:teal;">@@ -11,12 +11,14 @@</span> type token =
  | WHILE
  | DO
  | DONE
  <span style="color:green;">| FOR</span>
  | LTE
  | ASGNOP
  | DEREF
  | PLUS
  | MINUS
  | MULT
  <span style="color:green;">| DIV</span>
  | LPAREN
  | RPAREN
  | EOF
<span style="font-weight:bold;">diff --git a/parser.mly b/parser.mly</span>
<span style="font-weight:bold;">index 45b03ea..daf7293 100644</span>
<span style="font-weight:bold;">--- a/parser.mly</span>
<span style="font-weight:bold;">+++ b/parser.mly</span>
<span style="color:teal;">@@ -19,20 +19,24 @@</span> let parseError loc = raise (Lexer.ParseError loc)
%token SEQ SKIP
%token IF THEN ELSE
%token WHILE DO DONE
<span style="color:green;">%token FOR</span> 
%token LTE
%token ASGNOP DEREF
%token PLUS
%token MINUS
%token MULT
<span style="color:green;">%token DIV</span>
%token LPAREN RPAREN
%token EOF
%right SEQ /* lowest precedence */
%nonassoc IFX
<span style="color:green;">%nonassoc FORX</span>
%nonassoc LTE
%right ASGNOP
%left PLUS
%left MINUS
%left MULT
<span style="color:green;">%left DIV</span>
%nonassoc DEREF       /* highest precedence */
%start main             /* the entry point */
%type &lt;ImpAST.expr&gt; main
<span style="color:teal;">@@ -49,6 +53,7 @@</span> expr:
  | expr PLUS expr             { Op ($1,Plus,$3, location()) }
  | expr MINUS expr            { Op ($1,Minus,$3, location()) }
  | expr MULT expr             { Op ($1,Mult,$3, location()) } 
  <span style="color:green;">| expr DIV expr             { Op ($1,Div,$3, location()) }</span> 
  | DEREF LOC                  { Loc ($2, location()) }
  | LOC ASGNOP expr            { Atrib ($1,$3, location()) }
  | expr LTE expr              { Op ($1, Mic, $3, location()) }
<span style="color:teal;">@@ -56,5 +61,7 @@</span> expr:
  | IF expr THEN expr ELSE expr %prec IFX
                               { If ($2, $4, $6, location()) }
  | WHILE expr DO expr DONE    { While ($2, $4, location()) }
  <span style="color:green;">| FOR LPAREN expr SEQ expr SEQ expr RPAREN expr %prec FORX</span>
<span style="color:green;">                               { For ($3, $5, $7, $9, location()) }</span>
  | error                      { parseError (location ()) }
;
<span style="font-weight:bold;">diff --git a/programs/todoFor.imp b/programs/todoFor.imp</span>
<span style="font-weight:bold;">index 644dd1a..1ca72f6 100644</span>
<span style="font-weight:bold;">--- a/programs/todoFor.imp</span>
<span style="font-weight:bold;">+++ b/programs/todoFor.imp</span>
<span style="color:teal;">@@ -1,4 +1,3 @@</span>
n := 1000;
for (x := 1; !x &lt;= !n; x := !x + 1) 
  y := !y + !x ; n := !n - 1

<span style="font-weight:bold;">diff --git a/semantics.cmi b/semantics.cmi</span>
<span style="font-weight:bold;">index b9a53ce..bf39430 100644</span>
Binary files a/semantics.cmi and b/semantics.cmi differ
<span style="font-weight:bold;">diff --git a/semantics.cmo b/semantics.cmo</span>
<span style="font-weight:bold;">index ad14580..9c232bc 100644</span>
Binary files a/semantics.cmo and b/semantics.cmo differ
<span style="font-weight:bold;">diff --git a/semantics.ml b/semantics.ml</span>
<span style="font-weight:bold;">index 889371c..ffc76e9 100644</span>
<span style="font-weight:bold;">--- a/semantics.ml</span>
<span style="font-weight:bold;">+++ b/semantics.ml</span>
<span style="color:teal;">@@ -5,6 +5,7 @@</span> let rec reduce = function
  | (Op(Int (n1,_),Plus,Int (n2,_),loc),s) -&gt; Some (Int (n1+n2,loc),s)             (*Op+*)
  | (Op(Int (n1,_),Minus,Int (n2,_),loc),s) -&gt; Some (Int (n1-n2,loc),s)             (* Op- *) 
  | (Op(Int (n1,_),Mult,Int (n2,_),loc),s) -&gt; Some (Int (n1*n2,loc),s)             (*Op* *)
  <span style="color:green;">| (Op(Int (n1,_),Div,Int (n2,_),loc),s) -&gt; Some (Int (n1/n2,loc),s)             (*Op* *)</span>
  | (Op(Int (n1,_),Mic,Int (n2,_),loc),s) -&gt; Some (Bool (n1&lt;=n2,loc),s)            (*Op&lt;=*)
  | (Op(Int (n1,loc1),op,e2,loc),s) -&gt;                                        (*OpD*)
    (match reduce (e2,s) with 
<span style="color:teal;">@@ -30,6 +31,8 @@</span> let rec reduce = function
    (match reduce (e,s) with Some (e',s') -&gt; Some (If(e',e1,e2,loc),s')
      | None -&gt; None)
  | (While(e1,e2,loc),s) -&gt; Some (If(e1,Secv(e2,While(e1,e2,loc),loc),Skip loc,loc),s) (*While*)
  <span style="color:green;">| (For(init,cond,incr,body,loc),s) </span>
<span style="color:green;">    -&gt; Some (Secv(init, While(cond,Secv(body, incr, loc), loc),loc), s)  (*For*)</span>
  | _ -&gt; None                                                    (*default*)


<span style="font-weight:bold;">diff --git a/types.cmi b/types.cmi</span>
<span style="font-weight:bold;">index 5726639..0358691 100644</span>
Binary files a/types.cmi and b/types.cmi differ
<span style="font-weight:bold;">diff --git a/types.cmo b/types.cmo</span>
<span style="font-weight:bold;">deleted file mode 100644</span>
<span style="font-weight:bold;">index c5cefdc..0000000</span>
Binary files a/types.cmo and /dev/null differ
<span style="font-weight:bold;">diff --git a/types.ml b/types.ml</span>
<span style="font-weight:bold;">index 39c914f..1775e5e 100644</span>
<span style="font-weight:bold;">--- a/types.ml</span>
<span style="font-weight:bold;">+++ b/types.ml</span>
<span style="color:teal;">@@ -34,6 +34,11 @@</span> let rec infertype m = function
     | (TInt, TInt) -&gt; TInt
     | (TInt, t) -&gt; raise (TypeError (e1, TInt, t))
     | (t,_) -&gt; raise (TypeError (e1, TInt, t)))
  <span style="color:green;">| Op(e1,Div,e2,_)</span>
<span style="color:green;">    -&gt; (match (infertype m e1, infertype m e2) with</span>
<span style="color:green;">     | (TInt, TInt) -&gt; TInt</span>
<span style="color:green;">     | (TInt, t) -&gt; raise (TypeError (e1, TInt, t))</span>
<span style="color:green;">     | (t,_) -&gt; raise (TypeError (e1, TInt, t)))</span>  
  | Op(e1,Mic,e2,_) -&gt; (match (infertype m e1, infertype m e2) with
     | (TInt, TInt) -&gt; TBool
     | (TInt, t) -&gt; raise (TypeError (e2, TInt, t))
<span style="color:teal;">@@ -56,6 +61,13 @@</span> let rec infertype m = function
     | (TBool, TUnit) -&gt; TUnit
     | (TBool, t) -&gt; raise (TypeError (e2, TUnit, t))
     | (t,_) -&gt; raise (TypeError (e1, TBool, t)))
  <span style="color:green;">| For (init, cond, incr, body, _) </span>
<span style="color:green;">    -&gt; (match (infertype m init, infertype m cond, inference m incr, infertype m body) with</span>
<span style="color:green;">     | (TUnit, TBool, TUnit, TUnit) -&gt; TUnit</span>
<span style="color:green;">     | (TUnit, TBool, TUnit, t) -&gt; raise (TypeError (body, TUnit, t))</span>
<span style="color:green;">     | (TUnit, TBool, t, _) -&gt; raise (TypeError (incr, TUnit, t))</span>
<span style="color:green;">     | (TUnit, t, _, _) -&gt; raise (TypeError (cond, TBool, t))</span>
<span style="color:green;">     | (t, _, _, _) -&gt; raise (TypeError (init, TUnit, t)))</span>


let type_check m e = try

<span style="color:olive;">commit 581801cfa4a4ec811d93a64d52cb3dbdfe67f0b3</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Nov 27 11:47:40 2014 +0200

    Add Subtraction

<span style="font-weight:bold;">diff --git a/imp.cmi b/imp.cmi</span>
<span style="font-weight:bold;">index e578965..d5d2be1 100644</span>
Binary files a/imp.cmi and b/imp.cmi differ
<span style="font-weight:bold;">diff --git a/imp.cmo b/imp.cmo</span>
<span style="font-weight:bold;">index 8c17fb8..32c102f 100644</span>
Binary files a/imp.cmo and b/imp.cmo differ
<span style="font-weight:bold;">diff --git a/imp.exe b/imp.exe</span>
<span style="font-weight:bold;">index cb8c978..5c798d4 100644</span>
Binary files a/imp.exe and b/imp.exe differ
<span style="font-weight:bold;">diff --git a/impAST.cmi b/impAST.cmi</span>
<span style="font-weight:bold;">index ae155ec..3ef4820 100644</span>
Binary files a/impAST.cmi and b/impAST.cmi differ
<span style="font-weight:bold;">diff --git a/impAST.cmo b/impAST.cmo</span>
<span style="font-weight:bold;">index 2c5ff93..bb1fac7 100644</span>
Binary files a/impAST.cmo and b/impAST.cmo differ
<span style="font-weight:bold;">diff --git a/impAST.ml b/impAST.ml</span>
<span style="font-weight:bold;">index 1336bf5..4a6e367 100644</span>
<span style="font-weight:bold;">--- a/impAST.ml</span>
<span style="font-weight:bold;">+++ b/impAST.ml</span>
<span style="color:teal;">@@ -2,11 +2,13 @@</span> type locatie = string

type op =
  | Plus
  <span style="color:green;">| Minus</span>
  | Mult
  | Mic

let string_of_op = function
  | Plus -&gt; &quot;+&quot;
  <span style="color:green;">| Minus -&gt; &quot;-&quot;</span>
  | Mult -&gt; &quot;*&quot;
  | Mic -&gt; &quot;&lt;=&quot;

<span style="font-weight:bold;">diff --git a/lexer.cmi b/lexer.cmi</span>
<span style="font-weight:bold;">index e2d8ec4..60aea48 100644</span>
Binary files a/lexer.cmi and b/lexer.cmi differ
<span style="font-weight:bold;">diff --git a/lexer.cmo b/lexer.cmo</span>
<span style="font-weight:bold;">index 070e560..8fb286c 100644</span>
Binary files a/lexer.cmo and b/lexer.cmo differ
<span style="font-weight:bold;">diff --git a/lexer.ml b/lexer.ml</span>
<span style="font-weight:bold;">index c69d762..a01645d 100644</span>
<span style="font-weight:bold;">--- a/lexer.ml</span>
<span style="font-weight:bold;">+++ b/lexer.ml</span>
<span style="color:teal;">@@ -43,12 +43,12 @@</span> let keyword_table = Hashtbl.create 20
# 44 &quot;lexer.ml&quot;
let __ocaml_lex_tables = {
  Lexing.lex_base = 
   <span style="color:red;">&quot;\000\000\242\255\243\255\075\000\245\255\246\255\000\000\248\255\</span>
<span style="color:red;">    \249\255\001\000\251\255\252\255\150\000\160\000\254\255\255\255\</span>
<span style="color:red;">    \250\255\247\255&quot;;</span><span style="color:green;">&quot;\000\000\241\255\242\255\075\000\244\255\245\255\000\000\247\255\</span>
<span style="color:green;">    \248\255\001\000\250\255\252\255\150\000\160\000\254\255\255\255\</span>
<span style="color:green;">    \249\255\246\255&quot;;</span>
  Lexing.lex_backtrk = 
   <span style="color:red;">&quot;\255\255\255\255\255\255\011\000\255\255\255\255\013\000\255\255\</span>
<span style="color:red;">    \255\255\013\000\255\255\255\255\002\000\013\000\255\255\255\255\</span><span style="color:green;">&quot;\255\255\255\255\255\255\012\000\255\255\255\255\014\000\255\255\</span>
<span style="color:green;">    \255\255\014\000\255\255\255\255\002\000\004\000\255\255\255\255\</span>
    \255\255\255\255&quot;;
  Lexing.lex_default = 
   &quot;\001\000\000\000\000\000\255\255\000\000\000\000\255\255\000\000\
<span style="color:teal;">@@ -207,60 +207,65 @@</span> let

  | 4 -&gt;
# 49 &quot;lexer.mll&quot;
                   ( <span style="color:red;">MULT</span><span style="color:green;">MINUS</span> )
# 212 &quot;lexer.ml&quot;

  | 5 -&gt;
# 50 &quot;lexer.mll&quot;
                   ( <span style="color:red;">LTE</span><span style="color:green;">MULT</span> )
# 217 &quot;lexer.ml&quot;

  | 6 -&gt;
# 51 &quot;lexer.mll&quot;
                   ( <span style="color:red;">LPAREN</span><span style="color:green;">LTE</span> )
# 222 &quot;lexer.ml&quot;

  | 7 -&gt;
# 52 &quot;lexer.mll&quot;
                   ( <span style="color:red;">RPAREN</span><span style="color:green;">LPAREN</span> )
# 227 &quot;lexer.ml&quot;

  | 8 -&gt;
# 53 &quot;lexer.mll&quot;
                   ( <span style="color:red;">ASGNOP</span><span style="color:green;">RPAREN</span> )
# 232 &quot;lexer.ml&quot;

  | 9 -&gt;
# 54 &quot;lexer.mll&quot;
                   ( <span style="color:red;">SEQ</span><span style="color:green;">ASGNOP</span> )
# 237 &quot;lexer.ml&quot;

  | 10 -&gt;
# 55 &quot;lexer.mll&quot;
                   ( <span style="color:red;">DEREF</span><span style="color:green;">SEQ</span> )
# 242 &quot;lexer.ml&quot;

  | 11 -&gt;
<span style="color:red;">let</span>
# 56 &quot;lexer.mll&quot;
                   <span style="color:green;">( DEREF )</span>
<span style="color:green;"># 247 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 12 -&gt;</span>
<span style="color:green;">let</span>
<span style="color:green;"># 57 &quot;lexer.mll&quot;</span>
                                                         id
# <span style="color:red;">248</span><span style="color:green;">253</span> &quot;lexer.ml&quot;
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# <span style="color:red;">57</span><span style="color:green;">58</span> &quot;lexer.mll&quot;
                   ( try Hashtbl.find keyword_table id 
                     with Not_found -&gt; LOC(id))
<span style="color:red;"># 253 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 12 -&gt;</span>
<span style="color:red;"># 59 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( EOF )</span>
# 258 &quot;lexer.ml&quot;

  | 13 -&gt;
# 60 &quot;lexer.mll&quot;
                   ( <span style="color:red;">lex_error lexbuf</span><span style="color:green;">EOF</span> )
# 263 &quot;lexer.ml&quot;

  <span style="color:green;">| 14 -&gt;</span>
<span style="color:green;"># 61 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( lex_error lexbuf )</span>
<span style="color:green;"># 268 &quot;lexer.ml&quot;</span>

  | __ocaml_lex_state -&gt; lexbuf.Lexing.refill_buff lexbuf; __ocaml_lex_token_rec lexbuf __ocaml_lex_state

;;
<span style="font-weight:bold;">diff --git a/lexer.mll b/lexer.mll</span>
<span style="font-weight:bold;">index e3c0e52..8009d40 100644</span>
<span style="font-weight:bold;">--- a/lexer.mll</span>
<span style="font-weight:bold;">+++ b/lexer.mll</span>
<span style="color:teal;">@@ -46,6 +46,7 @@</span> rule token = parse
  | [' ' '\t' '\r' ]     { token lexbuf }     (* skip blanks *)
  | ['-']?['0'-'9']+ as lxm { INT(int_of_string lxm) }
  | '+'            { PLUS }
  <span style="color:green;">| '-'            { MINUS }</span>
  | '*'            { MULT }
  | &quot;&lt;=&quot;           { LTE }
  | '('            { LPAREN }
<span style="font-weight:bold;">diff --git a/parser.cmi b/parser.cmi</span>
<span style="font-weight:bold;">index d603ccb..e3a3edd 100644</span>
Binary files a/parser.cmi and b/parser.cmi differ
<span style="font-weight:bold;">diff --git a/parser.cmo b/parser.cmo</span>
<span style="font-weight:bold;">index fcb0cc3..04e8247 100644</span>
Binary files a/parser.cmo and b/parser.cmo differ
<span style="font-weight:bold;">diff --git a/parser.ml b/parser.ml</span>
<span style="font-weight:bold;">index 1c02304..e2dc253 100644</span>
<span style="font-weight:bold;">--- a/parser.ml</span>
<span style="font-weight:bold;">+++ b/parser.ml</span>
<span style="color:teal;">@@ -15,6 +15,7 @@</span> type token =
  | ASGNOP
  | DEREF
  | PLUS
  <span style="color:green;">| MINUS</span>
  | MULT
  | LPAREN
  | RPAREN
<span style="color:teal;">@@ -35,7 +36,7 @@</span> let location () =  let start_pos = Parsing.symbol_start_pos () in

let parseError loc = raise (Lexer.ParseError loc)

# <span style="color:red;">39</span><span style="color:green;">40</span> &quot;parser.ml&quot;
let yytransl_const = [|
  259 (* TRUE *);
  260 (* FALSE *);
<span style="color:teal;">@@ -51,9 +52,10 @@</span> let yytransl_const = [|
  270 (* ASGNOP *);
  271 (* DEREF *);
  272 (* PLUS *);
  273 (* <span style="color:red;">MULT</span><span style="color:green;">MINUS</span> *);
  274 (* <span style="color:red;">LPAREN</span><span style="color:green;">MULT</span> *);
  275 (* <span style="color:green;">LPAREN *);</span>
<span style="color:green;">  276 (*</span> RPAREN *);
    0 (* EOF *);
    0|]

<span style="color:teal;">@@ -64,51 +66,56 @@</span> let yytransl_block = [|

let yylhs = &quot;\255\255\
\001\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
<span style="color:red;">\002\000\002\000\002\000\002\000\002\000\002\000\002\000\000\000&quot;</span><span style="color:green;">\002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\</span>
<span style="color:green;">\000\000&quot;</span>

let yylen = &quot;\002\000\
\002\000\001\000\001\000\001\000\001\000\003\000\003\000\003\000\
<span style="color:red;">\002\000\003\000\003\000\003\000\006\000\005\000\001\000\002\000&quot;</span><span style="color:green;">\003\000\002\000\003\000\003\000\003\000\006\000\005\000\001\000\</span>
<span style="color:green;">\002\000&quot;</span>

let yydefred = &quot;\000\000\
<span style="color:red;">\000\000\000\000\015\000\002\000\000\000\003\000\004\000\005\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\016\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\009\000\000\000\000\000\000\000\000\000\000\000\001\000\</span>
<span style="color:red;">\000\000\000\000\000\000\006\000\000\000\000\000\000\000\008\000\</span>
<span style="color:red;">\000\000\000\000\000\000\014\000\000\000&quot;</span><span style="color:green;">\000\000\000\000\016\000\002\000\000\000\003\000\004\000\005\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\017\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\010\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\001\000\000\000\000\000\000\000\006\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\009\000\000\000\000\000\000\000\015\000\000\000&quot;</span>

let yydgoto = &quot;\002\000\
\013\000\014\000&quot;

let yysindex = <span style="color:red;">&quot;\004\000\</span>
<span style="color:red;">\039\255\000\000\000\000\000\000\244\254\000\000\000\000\000\000\</span>
<span style="color:red;">\039\255\039\255\011\255\039\255\000\000\038\000\039\255\042\255\</span>
<span style="color:red;">\051\255\000\000\018\255\039\255\039\255\039\255\039\255\000\000\</span>
<span style="color:red;">\035\255\039\255\039\255\000\000\058\255\035\255\001\255\000\000\</span>
<span style="color:red;">\056\255\251\254\039\255\000\000\009\255&quot;</span><span style="color:green;">&quot;\255\255\</span>
<span style="color:green;">\044\255\000\000\000\000\000\000\248\254\000\000\000\000\000\000\</span>
<span style="color:green;">\044\255\044\255\006\255\044\255\000\000\049\000\044\255\048\255\</span>
<span style="color:green;">\057\255\000\000\022\255\044\255\044\255\044\255\044\255\044\255\</span>
<span style="color:green;">\000\000\008\255\044\255\044\255\000\000\083\255\008\255\241\254\</span>
<span style="color:green;">\002\255\000\000\067\255\074\255\044\255\000\000\252\254&quot;</span>

let yyrindex = &quot;\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
<span style="color:red;">\010\000\000\000\000\000\000\000\033\000\019\000\001\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\028\000&quot;</span><span style="color:green;">\000\000\021\000\000\000\000\000\000\000\036\000\031\000\011\000\</span>
<span style="color:green;">\001\000\000\000\000\000\000\000\000\000\000\000\041\000&quot;</span>

let yygindex = &quot;\000\000\
<span style="color:red;">\000\000\250\255&quot;</span><span style="color:green;">\000\000\251\255&quot;</span>

let yytablesize = <span style="color:red;">311</span><span style="color:green;">323</span>
let yytable = <span style="color:red;">&quot;\020\000\</span>
<span style="color:red;">\007\000\015\000\016\000\017\000\001\000\019\000\036\000\021\000\</span>
<span style="color:red;">\025\000\010\000\022\000\023\000\018\000\029\000\030\000\031\000\</span>
<span style="color:red;">\032\000\023\000\011\000\033\000\034\000\021\000\020\000\000\000\</span>
<span style="color:red;">\022\000\023\000\000\000\013\000\037\000\000\000\021\000\000\000\</span>
<span style="color:red;">\012\000\022\000\023\000\000\000\028\000\024\000\003\000\004\000\</span>
<span style="color:red;">\005\000\006\000\007\000\000\000\008\000\009\000\020\000\000\000\</span>
<span style="color:red;">\010\000\026\000\022\000\023\000\000\000\011\000\021\000\020\000\</span>
<span style="color:red;">\012\000\022\000\023\000\000\000\020\000\027\000\020\000\021\000\</span>
<span style="color:red;">\035\000\000\000\022\000\023\000\021\000\000\000\021\000\022\000\</span>
<span style="color:red;">\023\000\022\000\023\000\000\000\000\000\000\000\000\000\000\000\</span><span style="color:green;">&quot;\001\000\</span>
<span style="color:green;">\008\000\023\000\024\000\016\000\017\000\015\000\019\000\018\000\</span>
<span style="color:green;">\021\000\026\000\007\000\022\000\023\000\024\000\030\000\031\000\</span>
<span style="color:green;">\032\000\033\000\034\000\024\000\011\000\035\000\036\000\022\000\</span>
<span style="color:green;">\023\000\024\000\020\000\000\000\000\000\000\000\012\000\039\000\</span>
<span style="color:green;">\000\000\000\000\021\000\013\000\000\000\022\000\023\000\024\000\</span>
<span style="color:green;">\014\000\029\000\000\000\003\000\004\000\005\000\006\000\007\000\</span>
<span style="color:green;">\025\000\008\000\009\000\000\000\020\000\010\000\000\000\027\000\</span>
<span style="color:green;">\000\000\000\000\011\000\000\000\021\000\020\000\012\000\022\000\</span>
<span style="color:green;">\023\000\024\000\000\000\028\000\000\000\021\000\000\000\020\000\</span>
<span style="color:green;">\022\000\023\000\024\000\037\000\000\000\000\000\020\000\021\000\</span>
<span style="color:green;">\000\000\000\000\022\000\023\000\024\000\038\000\021\000\020\000\</span>
<span style="color:green;">\000\000\022\000\023\000\024\000\000\000\000\000\000\000\021\000\</span>
<span style="color:green;">\000\000\000\000\022\000\023\000\024\000\000\000\000\000\000\000\</span>
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
<span style="color:teal;">@@ -128,31 +135,30 @@</span> let yytable = &quot;\020\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\007\000\000\000\000\000\</span>
<span style="color:red;">\007\000\007\000\000\000\007\000\007\000\007\000\010\000\000\000\</span>
<span style="color:red;">\007\000\010\000\010\000\007\000\010\000\010\000\010\000\011\000\</span>
<span style="color:red;">\000\000\000\000\011\000\011\000\010\000\011\000\011\000\000\000\</span>
<span style="color:red;">\013\000\000\000\000\000\013\000\013\000\011\000\013\000\013\000\</span>
<span style="color:red;">\012\000\012\000\020\000\012\000\012\000\000\000\013\000\000\000\</span>
<span style="color:red;">\000\000\000\000\021\000\012\000\000\000\022\000\023\000&quot;</span><span style="color:green;">\000\000\000\000\000\000\000\000\000\000\008\000\000\000\000\000\</span>
<span style="color:green;">\008\000\008\000\000\000\008\000\008\000\008\000\000\000\007\000\</span>
<span style="color:green;">\008\000\008\000\007\000\007\000\008\000\007\000\007\000\007\000\</span>
<span style="color:green;">\000\000\011\000\007\000\000\000\011\000\011\000\007\000\011\000\</span>
<span style="color:green;">\011\000\011\000\000\000\012\000\000\000\000\000\012\000\012\000\</span>
<span style="color:green;">\011\000\012\000\012\000\013\000\013\000\014\000\013\000\013\000\</span>
<span style="color:green;">\014\000\014\000\012\000\014\000\014\000\020\000\000\000\013\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\014\000\021\000\000\000\000\000\</span>
<span style="color:green;">\022\000\023\000\024\000&quot;</span>

let yycheck = <span style="color:red;">&quot;\005\001\</span>
<span style="color:red;">\000\000\014\001\009\000\010\000\001\000\012\000\012\001\013\001\</span>
<span style="color:red;">\015\000\000\000\016\001\017\001\002\001\020\000\021\000\022\000\</span>
<span style="color:red;">\023\000\017\001\000\000\026\000\027\000\013\001\005\001\255\255\</span>
<span style="color:red;">\016\001\017\001\255\255\000\000\035\000\255\255\013\001\255\255\</span>
<span style="color:red;">\000\000\016\001\017\001\255\255\019\001\000\000\000\001\001\001\</span>
<span style="color:red;">\002\001\003\001\004\001\255\255\006\001\007\001\005\001\255\255\</span>
<span style="color:red;">\010\001\008\001\016\001\017\001\255\255\015\001\013\001\005\001\</span>
<span style="color:red;">\018\001\016\001\017\001\255\255\005\001\011\001\005\001\013\001\</span>
<span style="color:red;">\009\001\255\255\016\001\017\001\013\001\255\255\013\001\016\001\</span>
<span style="color:red;">\017\001\016\001\017\001\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span><span style="color:green;">&quot;\001\000\</span>
<span style="color:green;">\000\000\017\001\018\001\009\000\010\000\014\001\012\000\002\001\</span>
<span style="color:green;">\013\001\015\000\000\000\016\001\017\001\018\001\020\000\021\000\</span>
<span style="color:green;">\022\000\023\000\024\000\018\001\000\000\027\000\028\000\016\001\</span>
<span style="color:green;">\017\001\018\001\005\001\255\255\255\255\255\255\000\000\037\000\</span>
<span style="color:green;">\255\255\255\255\013\001\000\000\255\255\016\001\017\001\018\001\</span>
<span style="color:green;">\000\000\020\001\255\255\000\001\001\001\002\001\003\001\004\001\</span>
<span style="color:green;">\000\000\006\001\007\001\255\255\005\001\010\001\255\255\008\001\</span>
<span style="color:green;">\255\255\255\255\015\001\255\255\013\001\005\001\019\001\016\001\</span>
<span style="color:green;">\017\001\018\001\255\255\011\001\255\255\013\001\255\255\005\001\</span>
<span style="color:green;">\016\001\017\001\018\001\009\001\255\255\255\255\005\001\013\001\</span>
<span style="color:green;">\255\255\255\255\016\001\017\001\018\001\012\001\013\001\005\001\</span>
<span style="color:green;">\255\255\016\001\017\001\018\001\255\255\255\255\255\255\013\001\</span>
<span style="color:green;">\255\255\255\255\016\001\017\001\018\001\255\255\255\255\255\255\</span>
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
<span style="color:teal;">@@ -173,12 +179,14 @@</span> let yycheck = &quot;\005\001\
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
\255\255\255\255\255\255\255\255\255\255\005\001\255\255\255\255\
<span style="color:red;">\008\001\009\001\255\255\011\001\012\001\013\001\005\001\255\255\</span>
<span style="color:red;">\016\001\008\001\009\001\019\001\011\001\012\001\013\001\005\001\</span>
<span style="color:red;">\255\255\255\255\008\001\009\001\019\001\011\001\012\001\255\255\</span>
<span style="color:red;">\005\001\255\255\255\255\008\001\009\001\019\001\011\001\012\001\</span>
<span style="color:red;">\008\001\009\001\005\001\011\001\012\001\255\255\019\001\255\255\</span>
<span style="color:red;">\255\255\255\255\013\001\019\001\255\255\016\001\017\001&quot;</span><span style="color:green;">\008\001\009\001\255\255\011\001\012\001\013\001\255\255\005\001\</span>
<span style="color:green;">\016\001\017\001\008\001\009\001\020\001\011\001\012\001\013\001\</span>
<span style="color:green;">\255\255\005\001\016\001\255\255\008\001\009\001\020\001\011\001\</span>
<span style="color:green;">\012\001\013\001\255\255\005\001\255\255\255\255\008\001\009\001\</span>
<span style="color:green;">\020\001\011\001\012\001\008\001\009\001\005\001\011\001\012\001\</span>
<span style="color:green;">\008\001\009\001\020\001\011\001\012\001\005\001\255\255\020\001\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\020\001\013\001\255\255\255\255\</span>
<span style="color:green;">\016\001\017\001\018\001&quot;</span>

let yynames_const = &quot;\
  TRUE\000\
<span style="color:teal;">@@ -195,6 +203,7 @@</span> let yynames_const = &quot;\
  ASGNOP\000\
  DEREF\000\
  PLUS\000\
  <span style="color:green;">MINUS\000\</span>
  MULT\000\
  LPAREN\000\
  RPAREN\000\
<span style="color:teal;">@@ -211,111 +220,119 @@</span> let yyact = [|
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in
    Obj.repr(
# <span style="color:red;">39</span><span style="color:green;">41</span> &quot;parser.mly&quot;
                            ( _1 )
# <span style="color:red;">217</span><span style="color:green;">226</span> &quot;parser.ml&quot;
               : ImpAST.expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 0 : int) in
    Obj.repr(
# <span style="color:red;">42</span><span style="color:green;">44</span> &quot;parser.mly&quot;
                               ( Int (_1,location()) )
# <span style="color:red;">224</span><span style="color:green;">233</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    Obj.repr(
# <span style="color:red;">43</span><span style="color:green;">45</span> &quot;parser.mly&quot;
                               ( Bool (true, location()) )
# <span style="color:red;">230</span><span style="color:green;">239</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    Obj.repr(
# <span style="color:red;">44</span><span style="color:green;">46</span> &quot;parser.mly&quot;
                               ( Bool (false, location()) )
# <span style="color:red;">236</span><span style="color:green;">245</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    Obj.repr(
# <span style="color:red;">45</span><span style="color:green;">47</span> &quot;parser.mly&quot;
                               ( Skip (location()) )
# <span style="color:red;">242</span><span style="color:green;">251</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _2 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in
    Obj.repr(
# <span style="color:red;">46</span><span style="color:green;">48</span> &quot;parser.mly&quot;
                               ( _2 )
# <span style="color:red;">249</span><span style="color:green;">258</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">47</span><span style="color:green;">49</span> &quot;parser.mly&quot;
                               ( Op (_1,Plus,_3, location()) )
# <span style="color:red;">257</span><span style="color:green;">266</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">48</span><span style="color:green;">50 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Op (_1,Minus,_3, location()) )</span>
<span style="color:green;"># 274 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 51</span> &quot;parser.mly&quot;
                               ( Op (_1,Mult,_3, location()) )
# <span style="color:red;">265</span><span style="color:green;">282</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _2 = (Parsing.peek_val __caml_parser_env 0 : string) in
    Obj.repr(
# <span style="color:red;">49</span><span style="color:green;">52</span> &quot;parser.mly&quot;
                               ( Loc (_2, location()) )
# <span style="color:red;">272</span><span style="color:green;">289</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : string) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">50</span><span style="color:green;">53</span> &quot;parser.mly&quot;
                               ( Atrib (_1,_3, location()) )
# <span style="color:red;">280</span><span style="color:green;">297</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">51</span><span style="color:green;">54</span> &quot;parser.mly&quot;
                               ( Op (_1, Mic, _3, location()) )
# <span style="color:red;">288</span><span style="color:green;">305</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">52</span><span style="color:green;">55</span> &quot;parser.mly&quot;
                               ( Secv (_1,_3, location()) )
# <span style="color:red;">296</span><span style="color:green;">313</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _2 = (Parsing.peek_val __caml_parser_env 4 : 'expr) in
    let _4 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _6 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">54</span><span style="color:green;">57</span> &quot;parser.mly&quot;
                               ( If (_2, _4, _6, location()) )
# <span style="color:red;">305</span><span style="color:green;">322</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _2 = (Parsing.peek_val __caml_parser_env 3 : 'expr) in
    let _4 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in
    Obj.repr(
# <span style="color:red;">55</span><span style="color:green;">58</span> &quot;parser.mly&quot;
                               ( While (_2, _4, location()) )
# <span style="color:red;">313</span><span style="color:green;">330</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    Obj.repr(
# <span style="color:red;">56</span><span style="color:green;">59</span> &quot;parser.mly&quot;
                               ( parseError (location ()) )
# <span style="color:red;">319</span><span style="color:green;">336</span> &quot;parser.ml&quot;
               : 'expr))
(* Entry main *)
; (fun __caml_parser_env -&gt; raise (Parsing.YYexit (Parsing.peek_val __caml_parser_env 0)))
<span style="font-weight:bold;">diff --git a/parser.mli b/parser.mli</span>
<span style="font-weight:bold;">index a41823f..fcebdd6 100644</span>
<span style="font-weight:bold;">--- a/parser.mli</span>
<span style="font-weight:bold;">+++ b/parser.mli</span>
<span style="color:teal;">@@ -15,6 +15,7 @@</span> type token =
  | ASGNOP
  | DEREF
  | PLUS
  <span style="color:green;">| MINUS</span>
  | MULT
  | LPAREN
  | RPAREN
<span style="font-weight:bold;">diff --git a/parser.mly b/parser.mly</span>
<span style="font-weight:bold;">index 8b9191b..45b03ea 100644</span>
<span style="font-weight:bold;">--- a/parser.mly</span>
<span style="font-weight:bold;">+++ b/parser.mly</span>
<span style="color:teal;">@@ -22,6 +22,7 @@</span> let parseError loc = raise (Lexer.ParseError loc)
%token LTE
%token ASGNOP DEREF
%token PLUS
<span style="color:green;">%token MINUS</span>
%token MULT
%token LPAREN RPAREN
%token EOF
<span style="color:teal;">@@ -30,6 +31,7 @@</span> let parseError loc = raise (Lexer.ParseError loc)
%nonassoc LTE
%right ASGNOP
%left PLUS
<span style="color:green;">%left MINUS</span>
%left MULT
%nonassoc DEREF       /* highest precedence */
%start main             /* the entry point */
<span style="color:teal;">@@ -45,6 +47,7 @@</span> expr:
  | SKIP                       { Skip (location()) }
  | LPAREN expr RPAREN         { $2 }
  | expr PLUS expr             { Op ($1,Plus,$3, location()) }
  <span style="color:green;">| expr MINUS expr            { Op ($1,Minus,$3, location()) }</span>
  | expr MULT expr             { Op ($1,Mult,$3, location()) } 
  | DEREF LOC                  { Loc ($2, location()) }
  | LOC ASGNOP expr            { Atrib ($1,$3, location()) }
<span style="font-weight:bold;">diff --git a/programs/testMult.imp b/programs/testMult.imp</span>
<span style="font-weight:bold;">index 7876933..d0e725a 100644</span>
<span style="font-weight:bold;">--- a/programs/testMult.imp</span>
<span style="font-weight:bold;">+++ b/programs/testMult.imp</span>
<span style="color:teal;">@@ -1 +1 @@</span>
3 + 4 * 5 <span style="color:green;">- 2</span>
<span style="font-weight:bold;">diff --git a/semantics.cmi b/semantics.cmi</span>
<span style="font-weight:bold;">index 46ee8d5..b9a53ce 100644</span>
Binary files a/semantics.cmi and b/semantics.cmi differ
<span style="font-weight:bold;">diff --git a/semantics.cmo b/semantics.cmo</span>
<span style="font-weight:bold;">index d193e33..ad14580 100644</span>
Binary files a/semantics.cmo and b/semantics.cmo differ
<span style="font-weight:bold;">diff --git a/semantics.ml b/semantics.ml</span>
<span style="font-weight:bold;">index 5114ca2..889371c 100644</span>
<span style="font-weight:bold;">--- a/semantics.ml</span>
<span style="font-weight:bold;">+++ b/semantics.ml</span>
<span style="color:teal;">@@ -3,6 +3,7 @@</span> open ImpAST

let rec reduce = function
  | (Op(Int (n1,_),Plus,Int (n2,_),loc),s) -&gt; Some (Int (n1+n2,loc),s)             (*Op+*)
  <span style="color:green;">| (Op(Int (n1,_),Minus,Int (n2,_),loc),s) -&gt; Some (Int (n1-n2,loc),s)             (* Op- *)</span> 
  | (Op(Int (n1,_),Mult,Int (n2,_),loc),s) -&gt; Some (Int (n1*n2,loc),s)             (*Op* *)
  | (Op(Int (n1,_),Mic,Int (n2,_),loc),s) -&gt; Some (Bool (n1&lt;=n2,loc),s)            (*Op&lt;=*)
  | (Op(Int (n1,loc1),op,e2,loc),s) -&gt;                                        (*OpD*)
<span style="font-weight:bold;">diff --git a/types.cmi b/types.cmi</span>
<span style="font-weight:bold;">index 16f1065..5726639 100644</span>
Binary files a/types.cmi and b/types.cmi differ
<span style="font-weight:bold;">diff --git a/types.cmo b/types.cmo</span>
<span style="font-weight:bold;">index f37cdf9..c5cefdc 100644</span>
Binary files a/types.cmo and b/types.cmo differ
<span style="font-weight:bold;">diff --git a/types.ml b/types.ml</span>
<span style="font-weight:bold;">index 03543a8..39c914f 100644</span>
<span style="font-weight:bold;">--- a/types.ml</span>
<span style="font-weight:bold;">+++ b/types.ml</span>
<span style="color:teal;">@@ -24,6 +24,11 @@</span> let rec infertype m = function
     | (TInt, TInt) -&gt; TInt
     | (TInt, t) -&gt; raise (TypeError (e2, TInt, t))
     | (t,_) -&gt; raise (TypeError (e1, TInt, t)))
  <span style="color:green;">| Op(e1,Minus,e2,_)</span>
<span style="color:green;">    -&gt; (match (infertype m e1, infertype m e2) with</span>
<span style="color:green;">     | (TInt, TInt) -&gt; TInt</span>
<span style="color:green;">     | (TInt, t) -&gt; raise (TypeError (e2,TInt, t))</span>
<span style="color:green;">     | (t,_) -&gt; raise(TypeError (e1, TInt, t)))</span>  
  | Op(e1,Mult,e2,_)
    -&gt; (match (infertype m e1, infertype m e2) with
     | (TInt, TInt) -&gt; TInt

<span style="color:olive;">commit 0791a85f9c6d79f60beec3ecc1479c936a8f7d07</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Nov 27 11:22:46 2014 +0200

    Add Multiplication

<span style="font-weight:bold;">diff --git a/imp.cmi b/imp.cmi</span>
<span style="font-weight:bold;">index c1cb583..e578965 100644</span>
Binary files a/imp.cmi and b/imp.cmi differ
<span style="font-weight:bold;">diff --git a/imp.cmo b/imp.cmo</span>
<span style="font-weight:bold;">index 0d9e6f7..8c17fb8 100644</span>
Binary files a/imp.cmo and b/imp.cmo differ
<span style="font-weight:bold;">diff --git a/imp.exe b/imp.exe</span>
<span style="font-weight:bold;">index c6c186c..cb8c978 100644</span>
Binary files a/imp.exe and b/imp.exe differ
<span style="font-weight:bold;">diff --git a/impAST.cmi b/impAST.cmi</span>
<span style="font-weight:bold;">index a634313..ae155ec 100644</span>
Binary files a/impAST.cmi and b/impAST.cmi differ
<span style="font-weight:bold;">diff --git a/impAST.cmo b/impAST.cmo</span>
<span style="font-weight:bold;">index f2f9663..2c5ff93 100644</span>
Binary files a/impAST.cmo and b/impAST.cmo differ
<span style="font-weight:bold;">diff --git a/impAST.ml b/impAST.ml</span>
<span style="font-weight:bold;">index 28d3efd..1336bf5 100644</span>
<span style="font-weight:bold;">--- a/impAST.ml</span>
<span style="font-weight:bold;">+++ b/impAST.ml</span>
<span style="color:teal;">@@ -2,10 +2,12 @@</span> type locatie = string

type op =
  | Plus
  <span style="color:green;">| Mult</span>
  | Mic

let string_of_op = function
  | Plus -&gt; &quot;+&quot;
  <span style="color:green;">| Mult -&gt; &quot;*&quot;</span>
  | Mic -&gt; &quot;&lt;=&quot;

type expr =
<span style="font-weight:bold;">diff --git a/lexer.cmi b/lexer.cmi</span>
<span style="font-weight:bold;">index 771acdf..e2d8ec4 100644</span>
Binary files a/lexer.cmi and b/lexer.cmi differ
<span style="font-weight:bold;">diff --git a/lexer.cmo b/lexer.cmo</span>
<span style="font-weight:bold;">index 7044854..070e560 100644</span>
Binary files a/lexer.cmo and b/lexer.cmo differ
<span style="font-weight:bold;">diff --git a/lexer.ml b/lexer.ml</span>
<span style="font-weight:bold;">index 50ef3e9..c69d762 100644</span>
<span style="font-weight:bold;">--- a/lexer.ml</span>
<span style="font-weight:bold;">+++ b/lexer.ml</span>
<span style="color:teal;">@@ -43,26 +43,26 @@</span> let keyword_table = Hashtbl.create 20
# 44 &quot;lexer.ml&quot;
let __ocaml_lex_tables = {
  Lexing.lex_base = 
   <span style="color:red;">&quot;\000\000\243\255\244\255\075\000\246\255\247\255\000\000\249\255\</span>
<span style="color:red;">    \250\255\001\000\252\255\150\000\160\000\254\255\255\255\251\255\</span>
<span style="color:red;">    \248\255&quot;;</span><span style="color:green;">&quot;\000\000\242\255\243\255\075\000\245\255\246\255\000\000\248\255\</span>
<span style="color:green;">    \249\255\001\000\251\255\252\255\150\000\160\000\254\255\255\255\</span>
<span style="color:green;">    \250\255\247\255&quot;;</span>
  Lexing.lex_backtrk = 
   <span style="color:red;">&quot;\255\255\255\255\255\255\010\000\255\255\255\255\012\000\255\255\</span>
<span style="color:red;">    \255\255\012\000\255\255\002\000\012\000\255\255\255\255\255\255\</span>
<span style="color:red;">    \255\255&quot;;</span><span style="color:green;">&quot;\255\255\255\255\255\255\011\000\255\255\255\255\013\000\255\255\</span>
<span style="color:green;">    \255\255\013\000\255\255\255\255\002\000\013\000\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255&quot;;</span>
  Lexing.lex_default = 
   &quot;\001\000\000\000\000\000\255\255\000\000\000\000\255\255\000\000\
    <span style="color:red;">\000\000\255\255\000\000\255\255\255\255\000\000\000\000\000\000\</span>
<span style="color:red;">    \000\000&quot;;</span><span style="color:green;">\000\000\255\255\000\000\000\000\255\255\255\255\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000&quot;;</span>
  Lexing.lex_trans = 
   &quot;\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    <span style="color:red;">\000\000\013\000\014\000\000\000\000\000\013\000\000\000\000\000\</span><span style="color:green;">\000\000\014\000\015\000\000\000\000\000\014\000\000\000\000\000\</span>
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    <span style="color:red;">\013\000\004\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">    \008\000\007\000\000\000\010\000\000\000\012\000\000\000\000\000\</span>
<span style="color:red;">    \011\000\011\000\011\000\011\000\011\000\011\000\011\000\011\000\</span>
<span style="color:red;">    \011\000\011\000\006\000\005\000\009\000\016\000\015\000\000\000\</span><span style="color:green;">\014\000\004\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \008\000\007\000\010\000\011\000\000\000\013\000\000\000\000\000\</span>
<span style="color:green;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:green;">    \012\000\012\000\006\000\005\000\009\000\017\000\016\000\000\000\</span>
    \000\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
<span style="color:teal;">@@ -79,10 +79,10 @@</span> let __ocaml_lex_tables = {
    \000\000\000\000\003\000\000\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    <span style="color:red;">\003\000\003\000\003\000\003\000\003\000\003\000\011\000\011\000\</span>
<span style="color:red;">    \011\000\011\000\011\000\011\000\011\000\011\000\011\000\011\000\</span>
<span style="color:red;">    \011\000\011\000\011\000\011\000\011\000\011\000\011\000\011\000\</span>
<span style="color:red;">    \011\000\011\000\000\000\000\000\000\000\000\000\000\000\000\000\</span><span style="color:green;">\003\000\003\000\003\000\003\000\003\000\003\000\012\000\012\000\</span>
<span style="color:green;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:green;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:green;">    \012\000\012\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
<span style="color:teal;">@@ -114,7 +114,7 @@</span> let __ocaml_lex_tables = {
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \000\000\000\000\255\255\255\255\255\255\255\255\255\255\255\255\
    <span style="color:red;">\000\000\000\000\255\255\000\000\255\255\000\000\255\255\255\255\</span><span style="color:green;">\000\000\000\000\000\000\000\000\255\255\000\000\255\255\255\255\</span>
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\006\000\009\000\255\255\
    \255\255\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
<span style="color:teal;">@@ -133,10 +133,10 @@</span> let __ocaml_lex_tables = {
    \255\255\255\255\003\000\255\255\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    <span style="color:red;">\003\000\003\000\003\000\003\000\003\000\003\000\011\000\011\000\</span>
<span style="color:red;">    \011\000\011\000\011\000\011\000\011\000\011\000\011\000\011\000\</span><span style="color:green;">\003\000\003\000\003\000\003\000\003\000\003\000\012\000\012\000\</span>
    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\
    <span style="color:red;">\012\000\012\000\255\255\255\255\255\255\255\255\255\255\255\255\</span><span style="color:green;">\013\000\013\000\013\000\013\000\013\000\013\000\013\000\013\000\</span>
<span style="color:green;">    \013\000\013\000\255\255\255\255\255\255\255\255\255\255\255\255\</span>
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
<span style="color:teal;">@@ -207,55 +207,60 @@</span> let

  | 4 -&gt;
# 49 &quot;lexer.mll&quot;
                   ( <span style="color:red;">LTE</span><span style="color:green;">MULT</span> )
# 212 &quot;lexer.ml&quot;

  | 5 -&gt;
# 50 &quot;lexer.mll&quot;
                   ( <span style="color:red;">LPAREN</span><span style="color:green;">LTE</span> )
# 217 &quot;lexer.ml&quot;

  | 6 -&gt;
# 51 &quot;lexer.mll&quot;
                   ( <span style="color:red;">RPAREN</span><span style="color:green;">LPAREN</span> )
# 222 &quot;lexer.ml&quot;

  | 7 -&gt;
# 52 &quot;lexer.mll&quot;
                   ( <span style="color:red;">ASGNOP</span><span style="color:green;">RPAREN</span> )
# 227 &quot;lexer.ml&quot;

  | 8 -&gt;
# 53 &quot;lexer.mll&quot;
                   ( <span style="color:red;">SEQ</span><span style="color:green;">ASGNOP</span> )
# 232 &quot;lexer.ml&quot;

  | 9 -&gt;
# 54 &quot;lexer.mll&quot;
                   ( <span style="color:red;">DEREF</span><span style="color:green;">SEQ</span> )
# 237 &quot;lexer.ml&quot;

  | 10 -&gt;
<span style="color:red;">let</span>
# 55 &quot;lexer.mll&quot;
                   <span style="color:green;">( DEREF )</span>
<span style="color:green;"># 242 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 11 -&gt;</span>
<span style="color:green;">let</span>
<span style="color:green;"># 56 &quot;lexer.mll&quot;</span>
                                                         id
# <span style="color:red;">243</span><span style="color:green;">248</span> &quot;lexer.ml&quot;
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# <span style="color:red;">56</span><span style="color:green;">57</span> &quot;lexer.mll&quot;
                   ( try Hashtbl.find keyword_table id 
                     with Not_found -&gt; LOC(id))
<span style="color:red;"># 248 &quot;lexer.ml&quot;</span>

<span style="color:red;">  | 11 -&gt;</span>
<span style="color:red;"># 58 &quot;lexer.mll&quot;</span>
<span style="color:red;">                   ( EOF )</span>
# 253 &quot;lexer.ml&quot;

  | 12 -&gt;
# 59 &quot;lexer.mll&quot;
                   ( <span style="color:red;">lex_error lexbuf</span><span style="color:green;">EOF</span> )
# 258 &quot;lexer.ml&quot;

  <span style="color:green;">| 13 -&gt;</span>
<span style="color:green;"># 60 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( lex_error lexbuf )</span>
<span style="color:green;"># 263 &quot;lexer.ml&quot;</span>

  | __ocaml_lex_state -&gt; lexbuf.Lexing.refill_buff lexbuf; __ocaml_lex_token_rec lexbuf __ocaml_lex_state

;;
<span style="font-weight:bold;">diff --git a/lexer.mll b/lexer.mll</span>
<span style="font-weight:bold;">index d1d7717..e3c0e52 100644</span>
<span style="font-weight:bold;">--- a/lexer.mll</span>
<span style="font-weight:bold;">+++ b/lexer.mll</span>
<span style="color:teal;">@@ -46,6 +46,7 @@</span> rule token = parse
  | [' ' '\t' '\r' ]     { token lexbuf }     (* skip blanks *)
  | ['-']?['0'-'9']+ as lxm { INT(int_of_string lxm) }
  | '+'            { PLUS }
  <span style="color:green;">| '*'            { MULT }</span>
  | &quot;&lt;=&quot;           { LTE }
  | '('            { LPAREN }
  | ')'            { RPAREN }
<span style="font-weight:bold;">diff --git a/parser.cmi b/parser.cmi</span>
<span style="font-weight:bold;">index 76fe4cf..d603ccb 100644</span>
Binary files a/parser.cmi and b/parser.cmi differ
<span style="font-weight:bold;">diff --git a/parser.cmo b/parser.cmo</span>
<span style="font-weight:bold;">index c398f1b..fcb0cc3 100644</span>
Binary files a/parser.cmo and b/parser.cmo differ
<span style="font-weight:bold;">diff --git a/parser.ml b/parser.ml</span>
<span style="font-weight:bold;">index d5728e8..1c02304 100644</span>
<span style="font-weight:bold;">--- a/parser.ml</span>
<span style="font-weight:bold;">+++ b/parser.ml</span>
<span style="color:teal;">@@ -15,6 +15,7 @@</span> type token =
  | ASGNOP
  | DEREF
  | PLUS
  <span style="color:green;">| MULT</span>
  | LPAREN
  | RPAREN
  | EOF
<span style="color:teal;">@@ -34,7 +35,7 @@</span> let location () =  let start_pos = Parsing.symbol_start_pos () in

let parseError loc = raise (Lexer.ParseError loc)

# <span style="color:red;">38</span><span style="color:green;">39</span> &quot;parser.ml&quot;
let yytransl_const = [|
  259 (* TRUE *);
  260 (* FALSE *);
<span style="color:teal;">@@ -50,8 +51,9 @@</span> let yytransl_const = [|
  270 (* ASGNOP *);
  271 (* DEREF *);
  272 (* PLUS *);
  273 (* <span style="color:red;">LPAREN</span><span style="color:green;">MULT</span> *);
  274 (* <span style="color:green;">LPAREN *);</span>
<span style="color:green;">  275 (*</span> RPAREN *);
    0 (* EOF *);
    0|]

<span style="color:teal;">@@ -62,51 +64,51 @@</span> let yytransl_block = [|

let yylhs = &quot;\255\255\
\001\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
<span style="color:red;">\002\000\002\000\002\000\002\000\002\000\002\000\000\000&quot;</span><span style="color:green;">\002\000\002\000\002\000\002\000\002\000\002\000\002\000\000\000&quot;</span>

let yylen = &quot;\002\000\
<span style="color:red;">\002\000\001\000\001\000\001\000\001\000\003\000\003\000\002\000\</span>
<span style="color:red;">\003\000\003\000\003\000\006\000\005\000\001\000\002\000&quot;</span><span style="color:green;">\002\000\001\000\001\000\001\000\001\000\003\000\003\000\003\000\</span>
<span style="color:green;">\002\000\003\000\003\000\003\000\006\000\005\000\001\000\002\000&quot;</span>

let yydefred = &quot;\000\000\
<span style="color:red;">\000\000\000\000\014\000\002\000\000\000\003\000\004\000\005\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\015\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\008\000\000\000\000\000\000\000\000\000\001\000\000\000\</span>
<span style="color:red;">\000\000\000\000\006\000\000\000\000\000\007\000\000\000\000\000\</span>
<span style="color:red;">\000\000\013\000\000\000&quot;</span><span style="color:green;">\000\000\000\000\015\000\002\000\000\000\003\000\004\000\005\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\016\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\009\000\000\000\000\000\000\000\000\000\000\000\001\000\</span>
<span style="color:green;">\000\000\000\000\000\000\006\000\000\000\000\000\000\000\008\000\</span>
<span style="color:green;">\000\000\000\000\000\000\014\000\000\000&quot;</span>

let yydgoto = &quot;\002\000\
\013\000\014\000&quot;

let yysindex = &quot;\004\000\
<span style="color:red;">\028\255\000\000\000\000\000\000\249\254\000\000\000\000\000\000\</span>
<span style="color:red;">\028\255\028\255\020\255\028\255\000\000\002\000\028\255\031\255\</span>
<span style="color:red;">\035\255\000\000\251\254\028\255\028\255\028\255\000\000\008\255\</span>
<span style="color:red;">\028\255\028\255\000\000\005\255\008\255\000\000\044\255\049\255\</span>
<span style="color:red;">\028\255\000\000\010\255&quot;</span><span style="color:green;">\039\255\000\000\000\000\000\000\244\254\000\000\000\000\000\000\</span>
<span style="color:green;">\039\255\039\255\011\255\039\255\000\000\038\000\039\255\042\255\</span>
<span style="color:green;">\051\255\000\000\018\255\039\255\039\255\039\255\039\255\000\000\</span>
<span style="color:green;">\035\255\039\255\039\255\000\000\058\255\035\255\001\255\000\000\</span>
<span style="color:green;">\056\255\251\254\039\255\000\000\009\255&quot;</span>

let yyrindex = &quot;\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\001\000\</span>
<span style="color:red;">\000\000\000\000\000\000\025\000\012\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\017\000&quot;</span><span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\010\000\000\000\000\000\000\000\033\000\019\000\001\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\028\000&quot;</span>

let yygindex = &quot;\000\000\
\000\000\250\255&quot;

let yytablesize = <span style="color:red;">299</span><span style="color:green;">311</span>
let yytable = &quot;\020\000\
<span style="color:red;">\009\000\023\000\016\000\017\000\001\000\019\000\015\000\021\000\</span>
<span style="color:red;">\024\000\020\000\022\000\010\000\027\000\028\000\029\000\030\000\</span>
<span style="color:red;">\012\000\021\000\031\000\032\000\022\000\018\000\021\000\022\000\</span>
<span style="color:red;">\011\000\022\000\035\000\003\000\004\000\005\000\006\000\007\000\</span>
<span style="color:red;">\000\000\008\000\009\000\020\000\000\000\010\000\025\000\020\000\</span>
<span style="color:red;">\000\000\000\000\011\000\021\000\012\000\026\000\022\000\021\000\</span>
<span style="color:red;">\020\000\000\000\022\000\000\000\033\000\020\000\000\000\000\000\</span>
<span style="color:red;">\021\000\000\000\000\000\022\000\034\000\021\000\000\000\000\000\</span>
<span style="color:red;">\022\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span><span style="color:green;">\007\000\015\000\016\000\017\000\001\000\019\000\036\000\021\000\</span>
<span style="color:green;">\025\000\010\000\022\000\023\000\018\000\029\000\030\000\031\000\</span>
<span style="color:green;">\032\000\023\000\011\000\033\000\034\000\021\000\020\000\000\000\</span>
<span style="color:green;">\022\000\023\000\000\000\013\000\037\000\000\000\021\000\000\000\</span>
<span style="color:green;">\012\000\022\000\023\000\000\000\028\000\024\000\003\000\004\000\</span>
<span style="color:green;">\005\000\006\000\007\000\000\000\008\000\009\000\020\000\000\000\</span>
<span style="color:green;">\010\000\026\000\022\000\023\000\000\000\011\000\021\000\020\000\</span>
<span style="color:green;">\012\000\022\000\023\000\000\000\020\000\027\000\020\000\021\000\</span>
<span style="color:green;">\035\000\000\000\022\000\023\000\021\000\000\000\021\000\022\000\</span>
<span style="color:green;">\023\000\022\000\023\000\000\000\000\000\000\000\000\000\000\000\</span>
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
<span style="color:teal;">@@ -129,23 +131,25 @@</span> let yytable = &quot;\020\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
<span style="color:red;">\000\000\000\000\000\000\000\000\000\000\009\000\020\000\000\000\</span>
<span style="color:red;">\009\000\009\000\000\000\009\000\009\000\009\000\021\000\000\000\</span>
<span style="color:red;">\010\000\022\000\009\000\010\000\010\000\012\000\010\000\010\000\</span>
<span style="color:red;">\012\000\012\000\000\000\012\000\012\000\010\000\000\000\000\000\</span>
<span style="color:red;">\011\000\011\000\012\000\011\000\011\000\000\000\000\000\000\000\</span>
<span style="color:red;">\000\000\000\000\011\000&quot;</span><span style="color:green;">\000\000\000\000\000\000\000\000\000\000\007\000\000\000\000\000\</span>
<span style="color:green;">\007\000\007\000\000\000\007\000\007\000\007\000\010\000\000\000\</span>
<span style="color:green;">\007\000\010\000\010\000\007\000\010\000\010\000\010\000\011\000\</span>
<span style="color:green;">\000\000\000\000\011\000\011\000\010\000\011\000\011\000\000\000\</span>
<span style="color:green;">\013\000\000\000\000\000\013\000\013\000\011\000\013\000\013\000\</span>
<span style="color:green;">\012\000\012\000\020\000\012\000\012\000\000\000\013\000\000\000\</span>
<span style="color:green;">\000\000\000\000\021\000\012\000\000\000\022\000\023\000&quot;</span>

let yycheck = &quot;\005\001\
<span style="color:red;">\000\000\000\000\009\000\010\000\001\000\012\000\014\001\013\001\</span>
<span style="color:red;">\015\000\005\001\016\001\000\000\018\001\020\000\021\000\022\000\</span>
<span style="color:red;">\000\000\013\001\025\000\026\000\016\001\002\001\013\001\016\001\</span>
<span style="color:red;">\000\000\016\001\033\000\000\001\001\001\002\001\003\001\004\001\</span>
<span style="color:red;">\255\255\006\001\007\001\005\001\255\255\010\001\008\001\005\001\</span>
<span style="color:red;">\255\255\255\255\015\001\013\001\017\001\011\001\016\001\013\001\</span>
<span style="color:red;">\005\001\255\255\016\001\255\255\009\001\005\001\255\255\255\255\</span>
<span style="color:red;">\013\001\255\255\255\255\016\001\012\001\013\001\255\255\255\255\</span>
<span style="color:red;">\016\001\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span><span style="color:green;">\000\000\014\001\009\000\010\000\001\000\012\000\012\001\013\001\</span>
<span style="color:green;">\015\000\000\000\016\001\017\001\002\001\020\000\021\000\022\000\</span>
<span style="color:green;">\023\000\017\001\000\000\026\000\027\000\013\001\005\001\255\255\</span>
<span style="color:green;">\016\001\017\001\255\255\000\000\035\000\255\255\013\001\255\255\</span>
<span style="color:green;">\000\000\016\001\017\001\255\255\019\001\000\000\000\001\001\001\</span>
<span style="color:green;">\002\001\003\001\004\001\255\255\006\001\007\001\005\001\255\255\</span>
<span style="color:green;">\010\001\008\001\016\001\017\001\255\255\015\001\013\001\005\001\</span>
<span style="color:green;">\018\001\016\001\017\001\255\255\005\001\011\001\005\001\013\001\</span>
<span style="color:green;">\009\001\255\255\016\001\017\001\013\001\255\255\013\001\016\001\</span>
<span style="color:green;">\017\001\016\001\017\001\255\255\255\255\255\255\255\255\255\255\</span>
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
<span style="color:teal;">@@ -168,13 +172,13 @@</span> let yycheck = &quot;\005\001\
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\255\255\255\255\255\255\005\001\005\001\255\255\</span>
<span style="color:red;">\008\001\009\001\255\255\011\001\012\001\013\001\013\001\255\255\</span>
<span style="color:red;">\005\001\016\001\018\001\008\001\009\001\005\001\011\001\012\001\</span>
<span style="color:red;">\008\001\009\001\255\255\011\001\012\001\018\001\255\255\255\255\</span>
<span style="color:red;">\008\001\009\001\018\001\011\001\012\001\255\255\255\255\255\255\</span>
<span style="color:red;">\255\255\255\255\018\001&quot;</span><span style="color:green;">\255\255\255\255\255\255\255\255\255\255\005\001\255\255\255\255\</span>
<span style="color:green;">\008\001\009\001\255\255\011\001\012\001\013\001\005\001\255\255\</span>
<span style="color:green;">\016\001\008\001\009\001\019\001\011\001\012\001\013\001\005\001\</span>
<span style="color:green;">\255\255\255\255\008\001\009\001\019\001\011\001\012\001\255\255\</span>
<span style="color:green;">\005\001\255\255\255\255\008\001\009\001\019\001\011\001\012\001\</span>
<span style="color:green;">\008\001\009\001\005\001\011\001\012\001\255\255\019\001\255\255\</span>
<span style="color:green;">\255\255\255\255\013\001\019\001\255\255\016\001\017\001&quot;</span>

let yynames_const = &quot;\
  TRUE\000\
<span style="color:teal;">@@ -191,6 +195,7 @@</span> let yynames_const = &quot;\
  ASGNOP\000\
  DEREF\000\
  PLUS\000\
  <span style="color:green;">MULT\000\</span>
  LPAREN\000\
  RPAREN\000\
  EOF\000\
<span style="color:teal;">@@ -206,103 +211,111 @@</span> let yyact = [|
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in
    Obj.repr(
# <span style="color:red;">37</span><span style="color:green;">39</span> &quot;parser.mly&quot;
                            ( _1 )
# <span style="color:red;">212</span><span style="color:green;">217</span> &quot;parser.ml&quot;
               : ImpAST.expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 0 : int) in
    Obj.repr(
# <span style="color:red;">40</span><span style="color:green;">42</span> &quot;parser.mly&quot;
                               ( Int (_1,location()) )
# <span style="color:red;">219</span><span style="color:green;">224</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    Obj.repr(
# <span style="color:red;">41</span><span style="color:green;">43</span> &quot;parser.mly&quot;
                               ( Bool (true, location()) )
# <span style="color:red;">225</span><span style="color:green;">230</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    Obj.repr(
# <span style="color:red;">42</span><span style="color:green;">44</span> &quot;parser.mly&quot;
                               ( Bool (false, location()) )
# <span style="color:red;">231</span><span style="color:green;">236</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    Obj.repr(
# <span style="color:red;">43</span><span style="color:green;">45</span> &quot;parser.mly&quot;
                               ( Skip (location()) )
# <span style="color:red;">237</span><span style="color:green;">242</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _2 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in
    Obj.repr(
# <span style="color:red;">44</span><span style="color:green;">46</span> &quot;parser.mly&quot;
                               ( _2 )
# <span style="color:red;">244</span><span style="color:green;">249</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">45</span><span style="color:green;">47</span> &quot;parser.mly&quot;
                               ( Op (_1,Plus,_3, location()) )
# <span style="color:red;">252</span><span style="color:green;">257 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 48 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Op (_1,Mult,_3, location()) )</span>
<span style="color:green;"># 265</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _2 = (Parsing.peek_val __caml_parser_env 0 : string) in
    Obj.repr(
# <span style="color:red;">46</span><span style="color:green;">49</span> &quot;parser.mly&quot;
                               ( Loc (_2, location()) )
# <span style="color:red;">259</span><span style="color:green;">272</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : string) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">47</span><span style="color:green;">50</span> &quot;parser.mly&quot;
                               ( Atrib (_1,_3, location()) )
# <span style="color:red;">267</span><span style="color:green;">280</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">48</span><span style="color:green;">51</span> &quot;parser.mly&quot;
                               ( Op (_1, Mic, _3, location()) )
# <span style="color:red;">275</span><span style="color:green;">288</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">49</span><span style="color:green;">52</span> &quot;parser.mly&quot;
                               ( Secv (_1,_3, location()) )
# <span style="color:red;">283</span><span style="color:green;">296</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _2 = (Parsing.peek_val __caml_parser_env 4 : 'expr) in
    let _4 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in
    let _6 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in
    Obj.repr(
# <span style="color:red;">51</span><span style="color:green;">54</span> &quot;parser.mly&quot;
                               ( If (_2, _4, _6, location()) )
# <span style="color:red;">292</span><span style="color:green;">305</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    let _2 = (Parsing.peek_val __caml_parser_env 3 : 'expr) in
    let _4 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in
    Obj.repr(
# <span style="color:red;">52</span><span style="color:green;">55</span> &quot;parser.mly&quot;
                               ( While (_2, _4, location()) )
# <span style="color:red;">300</span><span style="color:green;">313</span> &quot;parser.ml&quot;
               : 'expr))
; (fun __caml_parser_env -&gt;
    Obj.repr(
# <span style="color:red;">53</span><span style="color:green;">56</span> &quot;parser.mly&quot;
                               ( parseError (location ()) )
# <span style="color:red;">306</span><span style="color:green;">319</span> &quot;parser.ml&quot;
               : 'expr))
(* Entry main *)
; (fun __caml_parser_env -&gt; raise (Parsing.YYexit (Parsing.peek_val __caml_parser_env 0)))
<span style="font-weight:bold;">diff --git a/parser.mli b/parser.mli</span>
<span style="font-weight:bold;">index 2a8b2c9..a41823f 100644</span>
<span style="font-weight:bold;">--- a/parser.mli</span>
<span style="font-weight:bold;">+++ b/parser.mli</span>
<span style="color:teal;">@@ -15,6 +15,7 @@</span> type token =
  | ASGNOP
  | DEREF
  | PLUS
  <span style="color:green;">| MULT</span>
  | LPAREN
  | RPAREN
  | EOF
<span style="font-weight:bold;">diff --git a/parser.mly b/parser.mly</span>
<span style="font-weight:bold;">index c80179b..8b9191b 100644</span>
<span style="font-weight:bold;">--- a/parser.mly</span>
<span style="font-weight:bold;">+++ b/parser.mly</span>
<span style="color:teal;">@@ -22,6 +22,7 @@</span> let parseError loc = raise (Lexer.ParseError loc)
%token LTE
%token ASGNOP DEREF
%token PLUS
<span style="color:green;">%token MULT</span>
%token LPAREN RPAREN
%token EOF
%right SEQ /* lowest precedence */
<span style="color:teal;">@@ -29,6 +30,7 @@</span> let parseError loc = raise (Lexer.ParseError loc)
%nonassoc LTE
%right ASGNOP
%left PLUS
<span style="color:green;">%left MULT</span>
%nonassoc DEREF       /* highest precedence */
%start main             /* the entry point */
%type &lt;ImpAST.expr&gt; main
<span style="color:teal;">@@ -43,6 +45,7 @@</span> expr:
  | SKIP                       { Skip (location()) }
  | LPAREN expr RPAREN         { $2 }
  | expr PLUS expr             { Op ($1,Plus,$3, location()) }
  <span style="color:green;">| expr MULT expr             { Op ($1,Mult,$3, location()) }</span> 
  | DEREF LOC                  { Loc ($2, location()) }
  | LOC ASGNOP expr            { Atrib ($1,$3, location()) }
  | expr LTE expr              { Op ($1, Mic, $3, location()) }
<span style="font-weight:bold;">diff --git a/programs/testMult.imp b/programs/testMult.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..7876933</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testMult.imp</span>
<span style="color:teal;">@@ -0,0 +1 @@</span>
<span style="color:green;">3 + 4 * 5</span>
<span style="font-weight:bold;">diff --git a/semantics.cmi b/semantics.cmi</span>
<span style="font-weight:bold;">index c38b862..46ee8d5 100644</span>
Binary files a/semantics.cmi and b/semantics.cmi differ
<span style="font-weight:bold;">diff --git a/semantics.cmo b/semantics.cmo</span>
<span style="font-weight:bold;">index 0274d99..d193e33 100644</span>
Binary files a/semantics.cmo and b/semantics.cmo differ
<span style="font-weight:bold;">diff --git a/semantics.ml b/semantics.ml</span>
<span style="font-weight:bold;">index 4b89a8f..5114ca2 100644</span>
<span style="font-weight:bold;">--- a/semantics.ml</span>
<span style="font-weight:bold;">+++ b/semantics.ml</span>
<span style="color:teal;">@@ -3,6 +3,7 @@</span> open ImpAST

let rec reduce = function
  | (Op(Int (n1,_),Plus,Int (n2,_),loc),s) -&gt; Some (Int (n1+n2,loc),s)             (*Op+*)
  <span style="color:green;">| (Op(Int (n1,_),Mult,Int (n2,_),loc),s) -&gt; Some (Int (n1*n2,loc),s)             (*Op* *)</span>
  | (Op(Int (n1,_),Mic,Int (n2,_),loc),s) -&gt; Some (Bool (n1&lt;=n2,loc),s)            (*Op&lt;=*)
  | (Op(Int (n1,loc1),op,e2,loc),s) -&gt;                                        (*OpD*)
    (match reduce (e2,s) with 
<span style="font-weight:bold;">diff --git a/types.cmi b/types.cmi</span>
<span style="font-weight:bold;">index b810d24..16f1065 100644</span>
Binary files a/types.cmi and b/types.cmi differ
<span style="font-weight:bold;">diff --git a/types.cmo b/types.cmo</span>
<span style="font-weight:bold;">index 2f9aec0..f37cdf9 100644</span>
Binary files a/types.cmo and b/types.cmo differ
<span style="font-weight:bold;">diff --git a/types.ml b/types.ml</span>
<span style="font-weight:bold;">index a0bb6b2..03543a8 100644</span>
<span style="font-weight:bold;">--- a/types.ml</span>
<span style="font-weight:bold;">+++ b/types.ml</span>
<span style="color:teal;">@@ -24,6 +24,11 @@</span> let rec infertype m = function
     | (TInt, TInt) -&gt; TInt
     | (TInt, t) -&gt; raise (TypeError (e2, TInt, t))
     | (t,_) -&gt; raise (TypeError (e1, TInt, t)))
  <span style="color:green;">| Op(e1,Mult,e2,_)</span>
<span style="color:green;">    -&gt; (match (infertype m e1, infertype m e2) with</span>
<span style="color:green;">     | (TInt, TInt) -&gt; TInt</span>
<span style="color:green;">     | (TInt, t) -&gt; raise (TypeError (e1, TInt, t))</span>
<span style="color:green;">     | (t,_) -&gt; raise (TypeError (e1, TInt, t)))</span>
  | Op(e1,Mic,e2,_) -&gt; (match (infertype m e1, infertype m e2) with
     | (TInt, TInt) -&gt; TBool
     | (TInt, t) -&gt; raise (TypeError (e2, TInt, t))

<span style="color:olive;">commit ba6dc621c99f13a30637bb46ccc48a2b74859fe5</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Nov 27 11:02:00 2014 +0200

    Fix indentation in lexer.mll

<span style="font-weight:bold;">diff --git a/lexer.mll b/lexer.mll</span>
<span style="font-weight:bold;">index 02d5525..d1d7717 100644</span>
<span style="font-weight:bold;">--- a/lexer.mll</span>
<span style="font-weight:bold;">+++ b/lexer.mll</span>
<span style="color:teal;">@@ -51,7 +51,7 @@</span> rule token = parse
  | ')'            { RPAREN }
  | &quot;:=&quot;           { ASGNOP }
  | ';'            { SEQ }
  | '!'            { DEREF }
  | ['A'-'Z' 'a'-'z'] ['A'-'Z' 'a'-'z' '0'-'9' '_'] * as id
                   { try Hashtbl.find keyword_table id 
                     with Not_found -&gt; LOC(id)}

<span style="color:olive;">commit 9d126e508d1b57c94020b0e7db4e7a5e31d50449</span>
Author: Dragos Calin &lt;calinho_gx1992@yahoo.com&gt;
Date:   Thu Nov 27 11:00:52 2014 +0200

    Initial commit

<span style="font-weight:bold;">diff --git a/Makefile b/Makefile</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..5c095e5</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/Makefile</span>
<span style="color:teal;">@@ -0,0 +1,44 @@</span>


<span style="color:green;">all: imp</span>

<span style="color:green;">opt:</span>
<span style="color:green;">	ocamlopt -c impAST.ml</span>
<span style="color:green;">	ocamlyacc parser.mly</span>
<span style="color:green;">	ocamlopt -c parser.mli</span>
<span style="color:green;">	ocamllex lexer.mll</span>
<span style="color:green;">	ocamlopt -c lexer.ml</span>
<span style="color:green;">	ocamlopt -c parser.ml</span>
<span style="color:green;">	ocamlopt -c mem.ml</span>
<span style="color:green;">	ocamlopt -c semantics.ml</span>
<span style="color:green;">	ocamlopt -c types.ml</span>
<span style="color:green;">	ocamlopt -c imp.ml</span>
<span style="color:green;">	ocamlopt -o imp-opt impAST.cmx lexer.cmx parser.cmx mem.cmx semantics.cmx types.cmx imp.cmx</span>

<span style="color:green;">lexer.ml: lexer.mll parser.cmi</span>
<span style="color:green;">	ocamllex lexer.mll</span>

<span style="color:green;">parser.ml: parser.mly</span>
<span style="color:green;">	ocamlyacc parser.mly</span>

<span style="color:green;">parser.cmi: parser.ml</span>
<span style="color:green;">	ocamlc -c parser.mli</span>

<span style="color:green;">types.cmo: types.ml mem.cmo impAST.cmo</span>
<span style="color:green;">	ocamlc -c types.ml</span>

<span style="color:green;">semantics.cmo: semantics.ml mem.cmo impAST.cmo</span>
<span style="color:green;">	ocamlc -c semantics.ml</span>

<span style="color:green;">imp.cmo: imp.ml semantics.cmo types.cmo</span>
<span style="color:green;">	ocamlc -c imp.ml</span>

<span style="color:green;">%.cmo: %.ml</span>
<span style="color:green;">	ocamlc -c $&lt;</span>

<span style="color:green;">imp: impAST.cmo lexer.cmo parser.cmo imp.cmo mem.cmo semantics.cmo types.cmo</span>
<span style="color:green;">	ocamlc -o imp impAST.cmo lexer.cmo parser.cmo mem.cmo semantics.cmo types.cmo imp.cmo</span>

<span style="color:green;">clean:</span>
<span style="color:green;">	rm -f lexer.ml parser.ml parser.mli *.cmo *.cmi imp</span>
<span style="color:green;">	rm -f *.cmx *.o</span>
<span style="font-weight:bold;">diff --git a/compile.bat b/compile.bat</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..5a8b2ef</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/compile.bat</span>
<span style="color:teal;">@@ -0,0 +1,11 @@</span>
<span style="color:green;">ocamlc -c impAST.ml</span>
<span style="color:green;">ocamlyacc parser.mly</span>
<span style="color:green;">ocamlc -c parser.mli</span>
<span style="color:green;">ocamllex lexer.mll</span>
<span style="color:green;">ocamlc -c lexer.ml</span>
<span style="color:green;">ocamlc -c parser.ml</span>
<span style="color:green;">ocamlc -c mem.ml</span>
<span style="color:green;">ocamlc -c semantics.ml</span>
<span style="color:green;">ocamlc -c types.ml</span>
<span style="color:green;">ocamlc -c imp.ml</span>
<span style="color:green;">ocamlc -o imp.exe impAST.cmo lexer.cmo parser.cmo mem.cmo semantics.cmo types.cmo imp.cmo</span>
<span style="font-weight:bold;">diff --git a/compile.sh b/compile.sh</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..7b01d7e</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/compile.sh</span>
<span style="color:teal;">@@ -0,0 +1,11 @@</span>
<span style="color:green;">ocamlc -c impAST.ml</span>
<span style="color:green;">ocamlyacc parser.mly</span>
<span style="color:green;">ocamlc -c parser.mli</span>
<span style="color:green;">ocamllex lexer.mll</span>
<span style="color:green;">ocamlc -c lexer.ml</span>
<span style="color:green;">ocamlc -c parser.ml</span>
<span style="color:green;">ocamlc -c mem.ml</span>
<span style="color:green;">ocamlc -c semantics.ml</span>
<span style="color:green;">ocamlc -c types.ml</span>
<span style="color:green;">ocamlc -c imp.ml</span>
<span style="color:green;">ocamlc -o imp impAST.cmo lexer.cmo parser.cmo mem.cmo semantics.cmo types.cmo imp.cmo</span>
<span style="font-weight:bold;">diff --git a/imp.cmi b/imp.cmi</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..c1cb583</span>
Binary files /dev/null and b/imp.cmi differ
<span style="font-weight:bold;">diff --git a/imp.cmo b/imp.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..0d9e6f7</span>
Binary files /dev/null and b/imp.cmo differ
<span style="font-weight:bold;">diff --git a/imp.exe b/imp.exe</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..c6c186c</span>
Binary files /dev/null and b/imp.exe differ
<span style="font-weight:bold;">diff --git a/imp.ml b/imp.ml</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..9e87dbf</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/imp.ml</span>
<span style="color:teal;">@@ -0,0 +1,37 @@</span>
<span style="color:green;">open Lexing</span>
<span style="color:green;">open Types</span>

<span style="color:green;">let rec init_mem v = function</span>
<span style="color:green;">  | [] -&gt; []</span>
<span style="color:green;">  | h::t -&gt; (h,v)::(init_mem v t)</span>

<span style="color:green;">exception Error of exn * (string*int * int * string (** string *))</span>


<span style="color:green;">let type_and_run pgm = </span>
<span style="color:green;">  let locs = ImpAST.locations pgm in</span>
<span style="color:green;">      if (type_check  (init_mem TIntRef locs) pgm) then begin</span>
<span style="color:green;">          Printf.printf &quot;The program typechecks. Executing...&quot; ;</span>
<span style="color:green;">          flush stdout ;</span>
<span style="color:green;">          let final = (Semantics.evaluate (pgm,init_mem 0 locs)) in</span>
<span style="color:green;">            Printf.printf &quot; done.\n Final configuration:\n\n  %s\n\n&quot; </span>
<span style="color:green;">                  (Semantics.string_of_config final) </span>
<span style="color:green;">      end else ()</span>


<span style="color:green;">let cin () =</span>
<span style="color:green;">      if Array.length Sys.argv &gt; 1</span>
<span style="color:green;">      then open_in Sys.argv.(1)</span>
<span style="color:green;">      else failwith &quot;please specify program file&quot;</span>

<span style="color:green;">let _ = </span>
<span style="color:green;">  let lexbuf = Lexing.from_channel (cin ()) in</span>
<span style="color:green;">    lexbuf.lex_curr_p &lt;- { lexbuf.lex_curr_p with pos_fname = Sys.argv.(1) };</span>
<span style="color:green;">    try </span>
<span style="color:green;">      let pgm = Parser.main Lexer.token lexbuf in</span>
<span style="color:green;">       type_and_run pgm</span>
<span style="color:green;">    with</span>
<span style="color:green;">      Lexer.LexerError (loc,tok) -&gt;</span>
<span style="color:green;">        Printf.eprintf &quot;Lexer Error: Unexpected token '%s' at %s\n&quot; (Lexing.lexeme lexbuf) loc</span>
<span style="color:green;">    | Lexer.ParseError loc -&gt;</span>
<span style="color:green;">        Printf.eprintf &quot;Parse Error: Unexpected token '%s' at %s\n&quot; (Lexing.lexeme lexbuf) loc</span>
<span style="font-weight:bold;">diff --git a/impAST.cmi b/impAST.cmi</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..a634313</span>
Binary files /dev/null and b/impAST.cmi differ
<span style="font-weight:bold;">diff --git a/impAST.cmo b/impAST.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..f2f9663</span>
Binary files /dev/null and b/impAST.cmo differ
<span style="font-weight:bold;">diff --git a/impAST.ml b/impAST.ml</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..28d3efd</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/impAST.ml</span>
<span style="color:teal;">@@ -0,0 +1,71 @@</span>
<span style="color:green;">type locatie = string</span>

<span style="color:green;">type op =</span>
<span style="color:green;">  | Plus</span>
<span style="color:green;">  | Mic</span>

<span style="color:green;">let string_of_op = function</span>
<span style="color:green;">  | Plus -&gt; &quot;+&quot;</span>
<span style="color:green;">  | Mic -&gt; &quot;&lt;=&quot;</span>

<span style="color:green;">type expr =</span>
<span style="color:green;">  | Bool of bool * locatie</span>
<span style="color:green;">  | Int of int * locatie</span>
<span style="color:green;">  | Loc of string * locatie</span>
<span style="color:green;">  | Op of expr * op * expr * locatie</span>
<span style="color:green;">  | Atrib of string * expr * locatie</span>
<span style="color:green;">  | Secv of expr * expr * locatie</span>
<span style="color:green;">  | If of expr * expr * expr * locatie</span>
<span style="color:green;">  | While of expr * expr * locatie</span>
<span style="color:green;">  | Skip of locatie</span>

<span style="color:green;">let rec string_of_expr = function</span>
<span style="color:green;">  | Int (i,_) -&gt; string_of_int i</span>
<span style="color:green;">  | Bool (b,_) -&gt; string_of_bool b</span>
<span style="color:green;">  | Loc (s,_) -&gt; &quot;!&quot; ^ s</span>
<span style="color:green;">  | Op (e1, b, e2,_) -&gt;</span>
<span style="color:green;">    &quot;(&quot; ^ (string_of_expr e1) ^ (string_of_op b) ^ (string_of_expr e2) ^ &quot;)&quot;</span>
<span style="color:green;">  | Atrib (s,e2,_) -&gt;</span>
<span style="color:green;">    s ^ &quot;:=&quot; ^ (string_of_expr e2)</span>
<span style="color:green;">  | If (e1, e2, e3,_) -&gt;</span>
<span style="color:green;">    &quot;if &quot; ^ (string_of_expr e1) ^ &quot;\nthen &quot; ^ (string_of_expr e2) ^ &quot;\nelse (&quot; ^ (string_of_expr e3) ^ &quot;)&quot;</span>
<span style="color:green;">  | While (e1, e2,_) -&gt;</span>
<span style="color:green;">    &quot;while &quot; ^ (string_of_expr e1) ^ &quot; do \n&quot; ^ (string_of_expr e2) ^ &quot;\ndone&quot;</span>
<span style="color:green;">  | Secv (e1,e2,_) -&gt;</span>
<span style="color:green;">    (string_of_expr e1) ^ &quot;;\n&quot; ^ (string_of_expr e2)</span>
<span style="color:green;">  | Skip _ -&gt; &quot;skip&quot;</span>


<span style="color:green;">let location = function</span>
<span style="color:green;">   | Int (_,l) -&gt; l</span>
<span style="color:green;">  | Bool (_,l) -&gt; l</span>
<span style="color:green;">  | Loc (_,l) -&gt; l</span>
<span style="color:green;">  | Op (_, _, _,l) -&gt; l</span>
<span style="color:green;">  | Atrib (_,_,l) -&gt; l</span>
<span style="color:green;">  | If (_, _, _,l) -&gt; l</span>
<span style="color:green;">  | While (_, _,l) -&gt; l</span>
<span style="color:green;">  | Secv (_,_,l) -&gt; l</span>
<span style="color:green;">  | Skip l -&gt; l</span>


<span style="color:green;">let rec insert x l = match l with</span>
<span style="color:green;">  | [] -&gt; [x]</span>
<span style="color:green;">  | h::t when h = x -&gt; l</span>
<span style="color:green;">  | h::t when x &lt; h -&gt; x::l</span>
<span style="color:green;">  | h::t -&gt; h::(insert x t)</span>

<span style="color:green;">let locations e =</span>
<span style="color:green;">    let rec locations locs = function</span>
<span style="color:green;">      | [] -&gt; locs</span>
<span style="color:green;">      | e::exps -&gt; (match e with</span>
<span style="color:green;">          | Bool _ | Int _ | Skip _ -&gt; locations locs exps</span>
<span style="color:green;">          | Loc (l,_) -&gt; locations (insert l locs) exps</span>
<span style="color:green;">          | Op(e1,_,e2,_) -&gt; locations locs (e1::e2::exps)</span>
<span style="color:green;">          | Atrib(l,e,_) -&gt; locations (insert l locs) (e::exps)</span>
<span style="color:green;">          | Secv(e1,e2,_) -&gt; locations locs (e1::e2::exps)</span>
<span style="color:green;">          | If(e1,e2,e3,_) -&gt; locations locs (e1::e2::e3::exps)</span>
<span style="color:green;">          | While(e1,e2,_) -&gt; locations locs (e1::e2::exps)</span>
<span style="color:green;">      )</span>
<span style="color:green;">    in locations [] [e]</span>


<span style="font-weight:bold;">diff --git a/lexer.cmi b/lexer.cmi</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..771acdf</span>
Binary files /dev/null and b/lexer.cmi differ
<span style="font-weight:bold;">diff --git a/lexer.cmo b/lexer.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..7044854</span>
Binary files /dev/null and b/lexer.cmo differ
<span style="font-weight:bold;">diff --git a/lexer.ml b/lexer.ml</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..50ef3e9</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/lexer.ml</span>
<span style="color:teal;">@@ -0,0 +1,262 @@</span>
<span style="color:green;"># 2 &quot;lexer.mll&quot;</span>
<span style="color:green;"> </span>
<span style="color:green;">open Parser        (* The type token is defined in parser.mli *)</span>

<span style="color:green;">exception LexerError of string * string</span>
<span style="color:green;">exception ParseError of string</span>

<span style="color:green;">(*  Code for maintaining line numbers while tokenizing *)</span>

<span style="color:green;">let incr_linenum lexbuf =</span>
<span style="color:green;">      let pos = lexbuf.Lexing.lex_curr_p in</span>
<span style="color:green;">      lexbuf.Lexing.lex_curr_p &lt;- { pos with</span>
<span style="color:green;">        (* incrementing line number *)</span>
<span style="color:green;">        Lexing.pos_lnum = pos.Lexing.pos_lnum + 1;</span>
<span style="color:green;">        (* setting offset for beggining of line *)</span>
<span style="color:green;">        Lexing.pos_bol = pos.Lexing.pos_cnum;</span>
<span style="color:green;">      }</span>

<span style="color:green;">let lex_error lexbuf =</span>
<span style="color:green;">         begin</span>
<span style="color:green;">           let curr = lexbuf.Lexing.lex_curr_p in</span>
<span style="color:green;">           let file = curr.Lexing.pos_fname</span>
<span style="color:green;">           and line = curr.Lexing.pos_lnum</span>
<span style="color:green;">           and cnum = curr.Lexing.pos_cnum - curr.Lexing.pos_bol</span>
<span style="color:green;">           and tok = Lexing.lexeme lexbuf in</span>
<span style="color:green;">              raise (LexerError (Printf.sprintf &quot;%s:%d.%d&quot; file line cnum,tok))</span>
<span style="color:green;">         end</span>

<span style="color:green;">let keyword_table = Hashtbl.create 20</span>
<span style="color:green;">  let _ =</span>
<span style="color:green;">    List.iter (fun (kwd, tok) -&gt; Hashtbl.add keyword_table kwd tok)</span>
<span style="color:green;">  [( &quot;if&quot;           , IF );</span>
<span style="color:green;">   ( &quot;then&quot;         , THEN );</span>
<span style="color:green;">   ( &quot;else&quot;         , ELSE );</span>
<span style="color:green;">   ( &quot;while&quot;        , WHILE );</span>
<span style="color:green;">   ( &quot;do&quot;           , DO );</span>
<span style="color:green;">   ( &quot;done&quot;         , DONE );</span>
<span style="color:green;">   ( &quot;true&quot;         , TRUE );</span>
<span style="color:green;">   ( &quot;false&quot;        , FALSE );</span>
<span style="color:green;">   ( &quot;skip&quot;         , SKIP )]</span>


<span style="color:green;"># 44 &quot;lexer.ml&quot;</span>
<span style="color:green;">let __ocaml_lex_tables = {</span>
<span style="color:green;">  Lexing.lex_base = </span>
<span style="color:green;">   &quot;\000\000\243\255\244\255\075\000\246\255\247\255\000\000\249\255\</span>
<span style="color:green;">    \250\255\001\000\252\255\150\000\160\000\254\255\255\255\251\255\</span>
<span style="color:green;">    \248\255&quot;;</span>
<span style="color:green;">  Lexing.lex_backtrk = </span>
<span style="color:green;">   &quot;\255\255\255\255\255\255\010\000\255\255\255\255\012\000\255\255\</span>
<span style="color:green;">    \255\255\012\000\255\255\002\000\012\000\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255&quot;;</span>
<span style="color:green;">  Lexing.lex_default = </span>
<span style="color:green;">   &quot;\001\000\000\000\000\000\255\255\000\000\000\000\255\255\000\000\</span>
<span style="color:green;">    \000\000\255\255\000\000\255\255\255\255\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000&quot;;</span>
<span style="color:green;">  Lexing.lex_trans = </span>
<span style="color:green;">   &quot;\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\013\000\014\000\000\000\000\000\013\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \013\000\004\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \008\000\007\000\000\000\010\000\000\000\012\000\000\000\000\000\</span>
<span style="color:green;">    \011\000\011\000\011\000\011\000\011\000\011\000\011\000\011\000\</span>
<span style="color:green;">    \011\000\011\000\006\000\005\000\009\000\016\000\015\000\000\000\</span>
<span style="color:green;">    \000\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\003\000\000\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\011\000\011\000\</span>
<span style="color:green;">    \011\000\011\000\011\000\011\000\011\000\011\000\011\000\011\000\</span>
<span style="color:green;">    \011\000\011\000\011\000\011\000\011\000\011\000\011\000\011\000\</span>
<span style="color:green;">    \011\000\011\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \002\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000&quot;;</span>
<span style="color:green;">  Lexing.lex_check = </span>
<span style="color:green;">   &quot;\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\000\000\000\000\255\255\255\255\000\000\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \000\000\000\000\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \000\000\000\000\255\255\000\000\255\255\000\000\255\255\255\255\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\006\000\009\000\255\255\</span>
<span style="color:green;">    \255\255\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">    \000\000\000\000\000\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\003\000\255\255\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\</span>
<span style="color:green;">    \003\000\003\000\003\000\003\000\003\000\003\000\011\000\011\000\</span>
<span style="color:green;">    \011\000\011\000\011\000\011\000\011\000\011\000\011\000\011\000\</span>
<span style="color:green;">    \012\000\012\000\012\000\012\000\012\000\012\000\012\000\012\000\</span>
<span style="color:green;">    \012\000\012\000\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \000\000\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">    \255\255&quot;;</span>
<span style="color:green;">  Lexing.lex_base_code = </span>
<span style="color:green;">   &quot;&quot;;</span>
<span style="color:green;">  Lexing.lex_backtrk_code = </span>
<span style="color:green;">   &quot;&quot;;</span>
<span style="color:green;">  Lexing.lex_default_code = </span>
<span style="color:green;">   &quot;&quot;;</span>
<span style="color:green;">  Lexing.lex_trans_code = </span>
<span style="color:green;">   &quot;&quot;;</span>
<span style="color:green;">  Lexing.lex_check_code = </span>
<span style="color:green;">   &quot;&quot;;</span>
<span style="color:green;">  Lexing.lex_code = </span>
<span style="color:green;">   &quot;&quot;;</span>
<span style="color:green;">}</span>

<span style="color:green;">let rec token lexbuf =</span>
<span style="color:green;">    __ocaml_lex_token_rec lexbuf 0</span>
<span style="color:green;">and __ocaml_lex_token_rec lexbuf __ocaml_lex_state =</span>
<span style="color:green;">  match Lexing.engine __ocaml_lex_tables __ocaml_lex_state lexbuf with</span>
<span style="color:green;">      | 0 -&gt;</span>
<span style="color:green;"># 45 &quot;lexer.mll&quot;</span>
<span style="color:green;">             ( incr_linenum lexbuf ; token lexbuf )</span>
<span style="color:green;"># 187 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 1 -&gt;</span>
<span style="color:green;"># 46 &quot;lexer.mll&quot;</span>
<span style="color:green;">                         ( token lexbuf )</span>
<span style="color:green;"># 192 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 2 -&gt;</span>
<span style="color:green;">let</span>
<span style="color:green;"># 47 &quot;lexer.mll&quot;</span>
<span style="color:green;">                        lxm</span>
<span style="color:green;"># 198 &quot;lexer.ml&quot;</span>
<span style="color:green;">= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in</span>
<span style="color:green;"># 47 &quot;lexer.mll&quot;</span>
<span style="color:green;">                            ( INT(int_of_string lxm) )</span>
<span style="color:green;"># 202 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 3 -&gt;</span>
<span style="color:green;"># 48 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( PLUS )</span>
<span style="color:green;"># 207 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 4 -&gt;</span>
<span style="color:green;"># 49 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( LTE )</span>
<span style="color:green;"># 212 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 5 -&gt;</span>
<span style="color:green;"># 50 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( LPAREN )</span>
<span style="color:green;"># 217 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 6 -&gt;</span>
<span style="color:green;"># 51 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( RPAREN )</span>
<span style="color:green;"># 222 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 7 -&gt;</span>
<span style="color:green;"># 52 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( ASGNOP )</span>
<span style="color:green;"># 227 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 8 -&gt;</span>
<span style="color:green;"># 53 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( SEQ )</span>
<span style="color:green;"># 232 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 9 -&gt;</span>
<span style="color:green;"># 54 &quot;lexer.mll&quot;</span>
<span style="color:green;">                  ( DEREF )</span>
<span style="color:green;"># 237 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 10 -&gt;</span>
<span style="color:green;">let</span>
<span style="color:green;"># 55 &quot;lexer.mll&quot;</span>
<span style="color:green;">                                                         id</span>
<span style="color:green;"># 243 &quot;lexer.ml&quot;</span>
<span style="color:green;">= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in</span>
<span style="color:green;"># 56 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( try Hashtbl.find keyword_table id </span>
<span style="color:green;">                     with Not_found -&gt; LOC(id))</span>
<span style="color:green;"># 248 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 11 -&gt;</span>
<span style="color:green;"># 58 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( EOF )</span>
<span style="color:green;"># 253 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | 12 -&gt;</span>
<span style="color:green;"># 59 &quot;lexer.mll&quot;</span>
<span style="color:green;">                   ( lex_error lexbuf )</span>
<span style="color:green;"># 258 &quot;lexer.ml&quot;</span>

<span style="color:green;">  | __ocaml_lex_state -&gt; lexbuf.Lexing.refill_buff lexbuf; __ocaml_lex_token_rec lexbuf __ocaml_lex_state</span>

<span style="color:green;">;;</span>

<span style="font-weight:bold;">diff --git a/lexer.mll b/lexer.mll</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..02d5525</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/lexer.mll</span>
<span style="color:teal;">@@ -0,0 +1,59 @@</span>
<span style="color:green;">(* File lexer.mll *)</span>
<span style="color:green;">{</span>
<span style="color:green;">open Parser        (* The type token is defined in parser.mli *)</span>

<span style="color:green;">exception LexerError of string * string</span>
<span style="color:green;">exception ParseError of string</span>

<span style="color:green;">(*  Code for maintaining line numbers while tokenizing *)</span>

<span style="color:green;">let incr_linenum lexbuf =</span>
<span style="color:green;">      let pos = lexbuf.Lexing.lex_curr_p in</span>
<span style="color:green;">      lexbuf.Lexing.lex_curr_p &lt;- { pos with</span>
<span style="color:green;">        (* incrementing line number *)</span>
<span style="color:green;">        Lexing.pos_lnum = pos.Lexing.pos_lnum + 1;</span>
<span style="color:green;">        (* setting offset for beggining of line *)</span>
<span style="color:green;">        Lexing.pos_bol = pos.Lexing.pos_cnum;</span>
<span style="color:green;">      }</span>

<span style="color:green;">let lex_error lexbuf =</span>
<span style="color:green;">         begin</span>
<span style="color:green;">           let curr = lexbuf.Lexing.lex_curr_p in</span>
<span style="color:green;">           let file = curr.Lexing.pos_fname</span>
<span style="color:green;">           and line = curr.Lexing.pos_lnum</span>
<span style="color:green;">           and cnum = curr.Lexing.pos_cnum - curr.Lexing.pos_bol</span>
<span style="color:green;">           and tok = Lexing.lexeme lexbuf in</span>
<span style="color:green;">              raise (LexerError (Printf.sprintf &quot;%s:%d.%d&quot; file line cnum,tok))</span>
<span style="color:green;">         end</span>

<span style="color:green;">let keyword_table = Hashtbl.create 20</span>
<span style="color:green;">  let _ =</span>
<span style="color:green;">    List.iter (fun (kwd, tok) -&gt; Hashtbl.add keyword_table kwd tok)</span>
<span style="color:green;">  [( &quot;if&quot;           , IF );</span>
<span style="color:green;">   ( &quot;then&quot;         , THEN );</span>
<span style="color:green;">   ( &quot;else&quot;         , ELSE );</span>
<span style="color:green;">   ( &quot;while&quot;        , WHILE );</span>
<span style="color:green;">   ( &quot;do&quot;           , DO );</span>
<span style="color:green;">   ( &quot;done&quot;         , DONE );</span>
<span style="color:green;">   ( &quot;true&quot;         , TRUE );</span>
<span style="color:green;">   ( &quot;false&quot;        , FALSE );</span>
<span style="color:green;">   ( &quot;skip&quot;         , SKIP )]</span>

<span style="color:green;">}</span>

<span style="color:green;">rule token = parse</span>
<span style="color:green;">    [ '\n' ] { incr_linenum lexbuf ; token lexbuf }</span>
<span style="color:green;">  | [' ' '\t' '\r' ]     { token lexbuf }     (* skip blanks *)</span>
<span style="color:green;">  | ['-']?['0'-'9']+ as lxm { INT(int_of_string lxm) }</span>
<span style="color:green;">  | '+'            { PLUS }</span>
<span style="color:green;">  | &quot;&lt;=&quot;           { LTE }</span>
<span style="color:green;">  | '('            { LPAREN }</span>
<span style="color:green;">  | ')'            { RPAREN }</span>
<span style="color:green;">  | &quot;:=&quot;           { ASGNOP }</span>
<span style="color:green;">  | ';'            { SEQ }</span>
<span style="color:green;"> | '!'            { DEREF }</span>
<span style="color:green;">  | ['A'-'Z' 'a'-'z'] ['A'-'Z' 'a'-'z' '0'-'9' '_'] * as id</span>
<span style="color:green;">                   { try Hashtbl.find keyword_table id </span>
<span style="color:green;">                     with Not_found -&gt; LOC(id)}</span>
<span style="color:green;">  | eof            { EOF }</span>
<span style="color:green;">  | _              { lex_error lexbuf }</span>
<span style="font-weight:bold;">diff --git a/mem.cmi b/mem.cmi</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..953b68e</span>
Binary files /dev/null and b/mem.cmi differ
<span style="font-weight:bold;">diff --git a/mem.cmo b/mem.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..42c04c1</span>
Binary files /dev/null and b/mem.cmo differ
<span style="font-weight:bold;">diff --git a/mem.ml b/mem.ml</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..441a5ce</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/mem.ml</span>
<span style="color:teal;">@@ -0,0 +1,16 @@</span>
<span style="color:green;">let rec lookup x = function</span>
<span style="color:green;">  | [] -&gt; raise Not_found</span>
<span style="color:green;">  | (y,v)::_ when x=y -&gt; v</span>
<span style="color:green;">  | _::s -&gt; lookup x s</span>

<span style="color:green;">let rec update (x,n) = function</span>
<span style="color:green;">  | [] -&gt; raise Not_found</span>
<span style="color:green;">  | (y,v)::s  when x=y -&gt; ((x,n)::s)</span>
<span style="color:green;">  | h::t -&gt; h::(update (x,n) t)</span>

<span style="color:green;">let string_of_mem = </span>
<span style="color:green;">  let string_of_pair (x,v) = x ^ &quot; |-&gt; &quot; ^ string_of_int v in</span>
<span style="color:green;">  let rec string_of_mem str = function</span>
<span style="color:green;">  | [] -&gt; str</span>
<span style="color:green;">  | p::t -&gt; string_of_mem (str ^ &quot;; &quot; ^ string_of_pair p) t</span>
<span style="color:green;">  in function [] -&gt; &quot;&quot; | p::t -&gt; string_of_mem (string_of_pair p) t</span>
<span style="font-weight:bold;">diff --git a/parser.cmi b/parser.cmi</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..76fe4cf</span>
Binary files /dev/null and b/parser.cmi differ
<span style="font-weight:bold;">diff --git a/parser.cmo b/parser.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..c398f1b</span>
Binary files /dev/null and b/parser.cmo differ
<span style="font-weight:bold;">diff --git a/parser.ml b/parser.ml</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..d5728e8</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/parser.ml</span>
<span style="color:teal;">@@ -0,0 +1,328 @@</span>
<span style="color:green;">type token =</span>
<span style="color:green;">  | INT of (int)</span>
<span style="color:green;">  | LOC of (string)</span>
<span style="color:green;">  | TRUE</span>
<span style="color:green;">  | FALSE</span>
<span style="color:green;">  | SEQ</span>
<span style="color:green;">  | SKIP</span>
<span style="color:green;">  | IF</span>
<span style="color:green;">  | THEN</span>
<span style="color:green;">  | ELSE</span>
<span style="color:green;">  | WHILE</span>
<span style="color:green;">  | DO</span>
<span style="color:green;">  | DONE</span>
<span style="color:green;">  | LTE</span>
<span style="color:green;">  | ASGNOP</span>
<span style="color:green;">  | DEREF</span>
<span style="color:green;">  | PLUS</span>
<span style="color:green;">  | LPAREN</span>
<span style="color:green;">  | RPAREN</span>
<span style="color:green;">  | EOF</span>

<span style="color:green;">open Parsing;;</span>
<span style="color:green;">let _ = parse_error;;</span>
<span style="color:green;"># 3 &quot;parser.mly&quot;</span>
<span style="color:green;">open ImpAST</span>
<span style="color:green;">open Lexing</span>

<span style="color:green;">let location () =  let start_pos = Parsing.symbol_start_pos () in</span>
<span style="color:green;">    let end_pos = Parsing.symbol_end_pos () in</span>
<span style="color:green;">    Printf.sprintf &quot;%s:%d.%d-%d.%d&quot;</span>
<span style="color:green;">      start_pos.pos_fname</span>
<span style="color:green;">      start_pos.pos_lnum (start_pos.pos_cnum - start_pos.pos_bol)</span>
<span style="color:green;">      end_pos.pos_lnum (end_pos.pos_cnum - end_pos.pos_bol)</span>

<span style="color:green;">let parseError loc = raise (Lexer.ParseError loc)</span>

<span style="color:green;"># 38 &quot;parser.ml&quot;</span>
<span style="color:green;">let yytransl_const = [|</span>
<span style="color:green;">  259 (* TRUE *);</span>
<span style="color:green;">  260 (* FALSE *);</span>
<span style="color:green;">  261 (* SEQ *);</span>
<span style="color:green;">  262 (* SKIP *);</span>
<span style="color:green;">  263 (* IF *);</span>
<span style="color:green;">  264 (* THEN *);</span>
<span style="color:green;">  265 (* ELSE *);</span>
<span style="color:green;">  266 (* WHILE *);</span>
<span style="color:green;">  267 (* DO *);</span>
<span style="color:green;">  268 (* DONE *);</span>
<span style="color:green;">  269 (* LTE *);</span>
<span style="color:green;">  270 (* ASGNOP *);</span>
<span style="color:green;">  271 (* DEREF *);</span>
<span style="color:green;">  272 (* PLUS *);</span>
<span style="color:green;">  273 (* LPAREN *);</span>
<span style="color:green;">  274 (* RPAREN *);</span>
<span style="color:green;">    0 (* EOF *);</span>
<span style="color:green;">    0|]</span>

<span style="color:green;">let yytransl_block = [|</span>
<span style="color:green;">  257 (* INT *);</span>
<span style="color:green;">  258 (* LOC *);</span>
<span style="color:green;">    0|]</span>

<span style="color:green;">let yylhs = &quot;\255\255\</span>
<span style="color:green;">\001\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\</span>
<span style="color:green;">\002\000\002\000\002\000\002\000\002\000\002\000\000\000&quot;</span>

<span style="color:green;">let yylen = &quot;\002\000\</span>
<span style="color:green;">\002\000\001\000\001\000\001\000\001\000\003\000\003\000\002\000\</span>
<span style="color:green;">\003\000\003\000\003\000\006\000\005\000\001\000\002\000&quot;</span>

<span style="color:green;">let yydefred = &quot;\000\000\</span>
<span style="color:green;">\000\000\000\000\014\000\002\000\000\000\003\000\004\000\005\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\015\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\008\000\000\000\000\000\000\000\000\000\001\000\000\000\</span>
<span style="color:green;">\000\000\000\000\006\000\000\000\000\000\007\000\000\000\000\000\</span>
<span style="color:green;">\000\000\013\000\000\000&quot;</span>

<span style="color:green;">let yydgoto = &quot;\002\000\</span>
<span style="color:green;">\013\000\014\000&quot;</span>

<span style="color:green;">let yysindex = &quot;\004\000\</span>
<span style="color:green;">\028\255\000\000\000\000\000\000\249\254\000\000\000\000\000\000\</span>
<span style="color:green;">\028\255\028\255\020\255\028\255\000\000\002\000\028\255\031\255\</span>
<span style="color:green;">\035\255\000\000\251\254\028\255\028\255\028\255\000\000\008\255\</span>
<span style="color:green;">\028\255\028\255\000\000\005\255\008\255\000\000\044\255\049\255\</span>
<span style="color:green;">\028\255\000\000\010\255&quot;</span>

<span style="color:green;">let yyrindex = &quot;\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\001\000\</span>
<span style="color:green;">\000\000\000\000\000\000\025\000\012\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\017\000&quot;</span>

<span style="color:green;">let yygindex = &quot;\000\000\</span>
<span style="color:green;">\000\000\250\255&quot;</span>

<span style="color:green;">let yytablesize = 299</span>
<span style="color:green;">let yytable = &quot;\020\000\</span>
<span style="color:green;">\009\000\023\000\016\000\017\000\001\000\019\000\015\000\021\000\</span>
<span style="color:green;">\024\000\020\000\022\000\010\000\027\000\028\000\029\000\030\000\</span>
<span style="color:green;">\012\000\021\000\031\000\032\000\022\000\018\000\021\000\022\000\</span>
<span style="color:green;">\011\000\022\000\035\000\003\000\004\000\005\000\006\000\007\000\</span>
<span style="color:green;">\000\000\008\000\009\000\020\000\000\000\010\000\025\000\020\000\</span>
<span style="color:green;">\000\000\000\000\011\000\021\000\012\000\026\000\022\000\021\000\</span>
<span style="color:green;">\020\000\000\000\022\000\000\000\033\000\020\000\000\000\000\000\</span>
<span style="color:green;">\021\000\000\000\000\000\022\000\034\000\021\000\000\000\000\000\</span>
<span style="color:green;">\022\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\000\000\000\000\000\000\009\000\020\000\000\000\</span>
<span style="color:green;">\009\000\009\000\000\000\009\000\009\000\009\000\021\000\000\000\</span>
<span style="color:green;">\010\000\022\000\009\000\010\000\010\000\012\000\010\000\010\000\</span>
<span style="color:green;">\012\000\012\000\000\000\012\000\012\000\010\000\000\000\000\000\</span>
<span style="color:green;">\011\000\011\000\012\000\011\000\011\000\000\000\000\000\000\000\</span>
<span style="color:green;">\000\000\000\000\011\000&quot;</span>

<span style="color:green;">let yycheck = &quot;\005\001\</span>
<span style="color:green;">\000\000\000\000\009\000\010\000\001\000\012\000\014\001\013\001\</span>
<span style="color:green;">\015\000\005\001\016\001\000\000\018\001\020\000\021\000\022\000\</span>
<span style="color:green;">\000\000\013\001\025\000\026\000\016\001\002\001\013\001\016\001\</span>
<span style="color:green;">\000\000\016\001\033\000\000\001\001\001\002\001\003\001\004\001\</span>
<span style="color:green;">\255\255\006\001\007\001\005\001\255\255\010\001\008\001\005\001\</span>
<span style="color:green;">\255\255\255\255\015\001\013\001\017\001\011\001\016\001\013\001\</span>
<span style="color:green;">\005\001\255\255\016\001\255\255\009\001\005\001\255\255\255\255\</span>
<span style="color:green;">\013\001\255\255\255\255\016\001\012\001\013\001\255\255\255\255\</span>
<span style="color:green;">\016\001\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\255\255\255\255\255\255\005\001\005\001\255\255\</span>
<span style="color:green;">\008\001\009\001\255\255\011\001\012\001\013\001\013\001\255\255\</span>
<span style="color:green;">\005\001\016\001\018\001\008\001\009\001\005\001\011\001\012\001\</span>
<span style="color:green;">\008\001\009\001\255\255\011\001\012\001\018\001\255\255\255\255\</span>
<span style="color:green;">\008\001\009\001\018\001\011\001\012\001\255\255\255\255\255\255\</span>
<span style="color:green;">\255\255\255\255\018\001&quot;</span>

<span style="color:green;">let yynames_const = &quot;\</span>
<span style="color:green;">  TRUE\000\</span>
<span style="color:green;">  FALSE\000\</span>
<span style="color:green;">  SEQ\000\</span>
<span style="color:green;">  SKIP\000\</span>
<span style="color:green;">  IF\000\</span>
<span style="color:green;">  THEN\000\</span>
<span style="color:green;">  ELSE\000\</span>
<span style="color:green;">  WHILE\000\</span>
<span style="color:green;">  DO\000\</span>
<span style="color:green;">  DONE\000\</span>
<span style="color:green;">  LTE\000\</span>
<span style="color:green;">  ASGNOP\000\</span>
<span style="color:green;">  DEREF\000\</span>
<span style="color:green;">  PLUS\000\</span>
<span style="color:green;">  LPAREN\000\</span>
<span style="color:green;">  RPAREN\000\</span>
<span style="color:green;">  EOF\000\</span>
<span style="color:green;">  &quot;</span>

<span style="color:green;">let yynames_block = &quot;\</span>
<span style="color:green;">  INT\000\</span>
<span style="color:green;">  LOC\000\</span>
<span style="color:green;">  &quot;</span>

<span style="color:green;">let yyact = [|</span>
<span style="color:green;">  (fun _ -&gt; failwith &quot;parser&quot;)</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 37 &quot;parser.mly&quot;</span>
<span style="color:green;">                            ( _1 )</span>
<span style="color:green;"># 212 &quot;parser.ml&quot;</span>
<span style="color:green;">               : ImpAST.expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 0 : int) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 40 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Int (_1,location()) )</span>
<span style="color:green;"># 219 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 41 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Bool (true, location()) )</span>
<span style="color:green;"># 225 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 42 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Bool (false, location()) )</span>
<span style="color:green;"># 231 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 43 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Skip (location()) )</span>
<span style="color:green;"># 237 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _2 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 44 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( _2 )</span>
<span style="color:green;"># 244 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 45 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Op (_1,Plus,_3, location()) )</span>
<span style="color:green;"># 252 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _2 = (Parsing.peek_val __caml_parser_env 0 : string) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 46 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Loc (_2, location()) )</span>
<span style="color:green;"># 259 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : string) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 47 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Atrib (_1,_3, location()) )</span>
<span style="color:green;"># 267 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 48 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Op (_1, Mic, _3, location()) )</span>
<span style="color:green;"># 275 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _1 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _3 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 49 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( Secv (_1,_3, location()) )</span>
<span style="color:green;"># 283 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _2 = (Parsing.peek_val __caml_parser_env 4 : 'expr) in</span>
<span style="color:green;">    let _4 = (Parsing.peek_val __caml_parser_env 2 : 'expr) in</span>
<span style="color:green;">    let _6 = (Parsing.peek_val __caml_parser_env 0 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 51 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( If (_2, _4, _6, location()) )</span>
<span style="color:green;"># 292 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    let _2 = (Parsing.peek_val __caml_parser_env 3 : 'expr) in</span>
<span style="color:green;">    let _4 = (Parsing.peek_val __caml_parser_env 1 : 'expr) in</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 52 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( While (_2, _4, location()) )</span>
<span style="color:green;"># 300 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">; (fun __caml_parser_env -&gt;</span>
<span style="color:green;">    Obj.repr(</span>
<span style="color:green;"># 53 &quot;parser.mly&quot;</span>
<span style="color:green;">                               ( parseError (location ()) )</span>
<span style="color:green;"># 306 &quot;parser.ml&quot;</span>
<span style="color:green;">               : 'expr))</span>
<span style="color:green;">(* Entry main *)</span>
<span style="color:green;">; (fun __caml_parser_env -&gt; raise (Parsing.YYexit (Parsing.peek_val __caml_parser_env 0)))</span>
<span style="color:green;">|]</span>
<span style="color:green;">let yytables =</span>
<span style="color:green;">  { Parsing.actions=yyact;</span>
<span style="color:green;">    Parsing.transl_const=yytransl_const;</span>
<span style="color:green;">    Parsing.transl_block=yytransl_block;</span>
<span style="color:green;">    Parsing.lhs=yylhs;</span>
<span style="color:green;">    Parsing.len=yylen;</span>
<span style="color:green;">    Parsing.defred=yydefred;</span>
<span style="color:green;">    Parsing.dgoto=yydgoto;</span>
<span style="color:green;">    Parsing.sindex=yysindex;</span>
<span style="color:green;">    Parsing.rindex=yyrindex;</span>
<span style="color:green;">    Parsing.gindex=yygindex;</span>
<span style="color:green;">    Parsing.tablesize=yytablesize;</span>
<span style="color:green;">    Parsing.table=yytable;</span>
<span style="color:green;">    Parsing.check=yycheck;</span>
<span style="color:green;">    Parsing.error_function=parse_error;</span>
<span style="color:green;">    Parsing.names_const=yynames_const;</span>
<span style="color:green;">    Parsing.names_block=yynames_block }</span>
<span style="color:green;">let main (lexfun : Lexing.lexbuf -&gt; token) (lexbuf : Lexing.lexbuf) =</span>
<span style="color:green;">   (Parsing.yyparse yytables 1 lexfun lexbuf : ImpAST.expr)</span>
<span style="font-weight:bold;">diff --git a/parser.mli b/parser.mli</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..2a8b2c9</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/parser.mli</span>
<span style="color:teal;">@@ -0,0 +1,23 @@</span>
<span style="color:green;">type token =</span>
<span style="color:green;">  | INT of (int)</span>
<span style="color:green;">  | LOC of (string)</span>
<span style="color:green;">  | TRUE</span>
<span style="color:green;">  | FALSE</span>
<span style="color:green;">  | SEQ</span>
<span style="color:green;">  | SKIP</span>
<span style="color:green;">  | IF</span>
<span style="color:green;">  | THEN</span>
<span style="color:green;">  | ELSE</span>
<span style="color:green;">  | WHILE</span>
<span style="color:green;">  | DO</span>
<span style="color:green;">  | DONE</span>
<span style="color:green;">  | LTE</span>
<span style="color:green;">  | ASGNOP</span>
<span style="color:green;">  | DEREF</span>
<span style="color:green;">  | PLUS</span>
<span style="color:green;">  | LPAREN</span>
<span style="color:green;">  | RPAREN</span>
<span style="color:green;">  | EOF</span>

<span style="color:green;">val main :</span>
<span style="color:green;">  (Lexing.lexbuf  -&gt; token) -&gt; Lexing.lexbuf -&gt; ImpAST.expr</span>
<span style="font-weight:bold;">diff --git a/parser.mly b/parser.mly</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..c80179b</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/parser.mly</span>
<span style="color:teal;">@@ -0,0 +1,54 @@</span>
<span style="color:green;">/* File parser.mly */</span>
<span style="color:green;">%{</span>
<span style="color:green;">open ImpAST</span>
<span style="color:green;">open Lexing</span>

<span style="color:green;">let location () =  let start_pos = Parsing.symbol_start_pos () in</span>
<span style="color:green;">    let end_pos = Parsing.symbol_end_pos () in</span>
<span style="color:green;">    Printf.sprintf &quot;%s:%d.%d-%d.%d&quot;</span>
<span style="color:green;">      start_pos.pos_fname</span>
<span style="color:green;">      start_pos.pos_lnum (start_pos.pos_cnum - start_pos.pos_bol)</span>
<span style="color:green;">      end_pos.pos_lnum (end_pos.pos_cnum - end_pos.pos_bol)</span>

<span style="color:green;">let parseError loc = raise (Lexer.ParseError loc)</span>

<span style="color:green;">%}</span>
<span style="color:green;">%token &lt;int&gt; INT</span>
<span style="color:green;">%token &lt;string&gt; LOC</span>
<span style="color:green;">%token TRUE FALSE</span>
<span style="color:green;">%token SEQ SKIP</span>
<span style="color:green;">%token IF THEN ELSE</span>
<span style="color:green;">%token WHILE DO DONE</span>
<span style="color:green;">%token LTE</span>
<span style="color:green;">%token ASGNOP DEREF</span>
<span style="color:green;">%token PLUS</span>
<span style="color:green;">%token LPAREN RPAREN</span>
<span style="color:green;">%token EOF</span>
<span style="color:green;">%right SEQ /* lowest precedence */</span>
<span style="color:green;">%nonassoc IFX</span>
<span style="color:green;">%nonassoc LTE</span>
<span style="color:green;">%right ASGNOP</span>
<span style="color:green;">%left PLUS</span>
<span style="color:green;">%nonassoc DEREF       /* highest precedence */</span>
<span style="color:green;">%start main             /* the entry point */</span>
<span style="color:green;">%type &lt;ImpAST.expr&gt; main</span>
<span style="color:green;">%%</span>
<span style="color:green;">main:</span>
<span style="color:green;">    expr EOF                { $1 }</span>
<span style="color:green;">;</span>
<span style="color:green;">expr:</span>
<span style="color:green;">    INT                        { Int ($1,location()) }</span>
<span style="color:green;">  | TRUE                       { Bool (true, location()) }</span>
<span style="color:green;">  | FALSE                      { Bool (false, location()) }</span>
<span style="color:green;">  | SKIP                       { Skip (location()) }</span>
<span style="color:green;">  | LPAREN expr RPAREN         { $2 }</span>
<span style="color:green;">  | expr PLUS expr             { Op ($1,Plus,$3, location()) }</span>
<span style="color:green;">  | DEREF LOC                  { Loc ($2, location()) }</span>
<span style="color:green;">  | LOC ASGNOP expr            { Atrib ($1,$3, location()) }</span>
<span style="color:green;">  | expr LTE expr              { Op ($1, Mic, $3, location()) }</span>
<span style="color:green;">  | expr SEQ expr              { Secv ($1,$3, location()) }</span>
<span style="color:green;">  | IF expr THEN expr ELSE expr %prec IFX</span>
<span style="color:green;">                               { If ($2, $4, $6, location()) }</span>
<span style="color:green;">  | WHILE expr DO expr DONE    { While ($2, $4, location()) }</span>
<span style="color:green;">  | error                      { parseError (location ()) }</span>
<span style="color:green;">;</span>
<span style="font-weight:bold;">diff --git a/programs/errTip.imp b/programs/errTip.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..9eb09fd</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/errTip.imp</span>
<span style="color:teal;">@@ -0,0 +1,7 @@</span>
<span style="color:green;">n := 10 ;</span>
<span style="color:green;">s := 0 ;</span>
<span style="color:green;">while 1 &lt;= !n do</span>
<span style="color:green;">  s := !s + !n ;</span>
<span style="color:green;">  n := !n + -1</span>
<span style="color:green;">done</span>

<span style="font-weight:bold;">diff --git a/programs/test1.imp b/programs/test1.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..6c8b0dd</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/test1.imp</span>
<span style="color:teal;">@@ -0,0 +1 @@</span>
<span style="color:green;">3 + 4</span>
<span style="font-weight:bold;">diff --git a/programs/test2.imp b/programs/test2.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..fc8a53f</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/test2.imp</span>
<span style="color:teal;">@@ -0,0 +1,4 @@</span>
<span style="color:green;">x := 3;</span>
<span style="color:green;">y := 7;</span>
<span style="color:green;">z := (!x + !y)</span> 

<span style="font-weight:bold;">diff --git a/programs/testIf.imp b/programs/testIf.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..1e622b7</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/testIf.imp</span>
<span style="color:teal;">@@ -0,0 +1,4 @@</span>
<span style="color:green;">n := 100;</span>
<span style="color:green;">if (!n &lt;= 100) then skip else</span>
<span style="color:green;">  y := !y + !x ;</span>
<span style="color:green;">n := !n + -1</span>
<span style="font-weight:bold;">diff --git a/programs/todoFor.imp b/programs/todoFor.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..644dd1a</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/todoFor.imp</span>
<span style="color:teal;">@@ -0,0 +1,4 @@</span>
<span style="color:green;">n := 1000;</span>
<span style="color:green;">for (x := 1; !x &lt;= !n; x := !x + 1)</span>
<span style="color:green;">  y := !y + !x ; n := !n - 1</span>

<span style="font-weight:bold;">diff --git a/programs/todoOps.imp b/programs/todoOps.imp</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..fc4969a</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/programs/todoOps.imp</span>
<span style="color:teal;">@@ -0,0 +1 @@</span>
<span style="color:green;">3 + 4 * 5 - 6 / 2 / 4</span>
<span style="font-weight:bold;">diff --git a/semantics.cmi b/semantics.cmi</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..c38b862</span>
Binary files /dev/null and b/semantics.cmi differ
<span style="font-weight:bold;">diff --git a/semantics.cmo b/semantics.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..0274d99</span>
Binary files /dev/null and b/semantics.cmo differ
<span style="font-weight:bold;">diff --git a/semantics.ml b/semantics.ml</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..4b89a8f</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/semantics.ml</span>
<span style="color:teal;">@@ -0,0 +1,41 @@</span>
<span style="color:green;">open Mem</span>
<span style="color:green;">open ImpAST</span>

<span style="color:green;">let rec reduce = function</span>
<span style="color:green;">  | (Op(Int (n1,_),Plus,Int (n2,_),loc),s) -&gt; Some (Int (n1+n2,loc),s)             (*Op+*)</span>
<span style="color:green;">  | (Op(Int (n1,_),Mic,Int (n2,_),loc),s) -&gt; Some (Bool (n1&lt;=n2,loc),s)            (*Op&lt;=*)</span>
<span style="color:green;">  | (Op(Int (n1,loc1),op,e2,loc),s) -&gt;                                        (*OpD*)</span>
<span style="color:green;">    (match reduce (e2,s) with </span>
<span style="color:green;">      | Some (e2',s') -&gt; Some (Op(Int (n1,loc1),op,e2',loc),s')</span>
<span style="color:green;">      | None -&gt; None</span>
<span style="color:green;">    )</span>
<span style="color:green;">  | (Op(e1,op,e2,loc),s) -&gt;                                            (*OpS*)</span>
<span style="color:green;">    (match reduce (e1,s) with Some (e1',s') -&gt; Some (Op(e1',op,e2,loc),s')</span>
<span style="color:green;">      | None -&gt; None)</span>
<span style="color:green;">  | (Loc (l,loc), s) -&gt; Some (Int (lookup l s,loc), s)                    (*Loc*)</span>
<span style="color:green;">  | (Atrib(l, Int (n,_),loc),s) -&gt;                                         (*Atrib*)</span>
<span style="color:green;">      Some (Skip loc, update (l,n) s)</span>
<span style="color:green;">  | (Atrib(l,e,loc),s) -&gt;                                          (*AtribD*)</span>
<span style="color:green;">    (match reduce (e,s) with Some (e',s') -&gt; Some (Atrib(l,e',loc),s')</span>
<span style="color:green;">      | None -&gt; None)</span>
<span style="color:green;">  | (Secv(Skip _,e,_),s) -&gt; Some (e,s)                                 (*Secv*)</span>
<span style="color:green;">  | (Secv(e1,e2,loc),s) -&gt;                                             (*SecvS*)</span>
<span style="color:green;">    (match reduce (e1,s) with Some (e1',s') -&gt; Some (Secv(e1',e2,loc),s')</span>
<span style="color:green;">      | None -&gt; None)</span>
<span style="color:green;">  | (If(Bool (true,_),e1,e2,_),s) -&gt; Some (e1,s)                         (*IfTrue*)</span>
<span style="color:green;">  | (If(Bool (false,_),e1,e2,_),s) -&gt; Some (e2,s)                        (*IfFalse*)</span>
<span style="color:green;">  | (If(e,e1,e2,loc),s) -&gt;                                             (*IfS*)</span>
<span style="color:green;">    (match reduce (e,s) with Some (e',s') -&gt; Some (If(e',e1,e2,loc),s')</span>
<span style="color:green;">      | None -&gt; None)</span>
<span style="color:green;">  | (While(e1,e2,loc),s) -&gt; Some (If(e1,Secv(e2,While(e1,e2,loc),loc),Skip loc,loc),s) (*While*)</span>
<span style="color:green;">  | _ -&gt; None                                                    (*default*)</span>


<span style="color:green;">(* evaluate basically computes the transitive closure -&gt;* of the</span>
<span style="color:green;">   one step reduction relation. *)</span>
<span style="color:green;">let rec evaluate c = match (reduce c) with</span>
<span style="color:green;">  | Some c -&gt; evaluate c</span>
<span style="color:green;">  | None -&gt; c</span>


<span style="color:green;">let string_of_config (p,m) = &quot;&lt;&quot; ^ string_of_expr p ^ &quot;, {&quot; ^ string_of_mem m ^ &quot;} &gt;&quot;</span>
<span style="font-weight:bold;">diff --git a/types.cmi b/types.cmi</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..b810d24</span>
Binary files /dev/null and b/types.cmi differ
<span style="font-weight:bold;">diff --git a/types.cmo b/types.cmo</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..2f9aec0</span>
Binary files /dev/null and b/types.cmo differ
<span style="font-weight:bold;">diff --git a/types.ml b/types.ml</span>
<span style="font-weight:bold;">new file mode 100644</span>
<span style="font-weight:bold;">index 0000000..a0bb6b2</span>
<span style="font-weight:bold;">--- /dev/null</span>
<span style="font-weight:bold;">+++ b/types.ml</span>
<span style="color:teal;">@@ -0,0 +1,57 @@</span>
<span style="color:green;">open Mem</span>
<span style="color:green;">open ImpAST</span>

<span style="color:green;">(* types of expressions *)</span>
<span style="color:green;">type tip = TInt | TBool | TUnit</span>

<span style="color:green;">let string_of_tip = function</span>
<span style="color:green;">  | TInt -&gt; &quot;int&quot;</span>
<span style="color:green;">  | TBool -&gt; &quot;bool&quot;</span>
<span style="color:green;">  | TUnit -&gt; &quot;unit&quot;</span>

<span style="color:green;">(* types of locations *)</span>
<span style="color:green;">type tipL = TIntRef</span>

<span style="color:green;">exception TypeError of expr*tip*tip</span>
<span style="color:green;">exception LocError of string*locatie</span>

<span style="color:green;">(* Type inference function *)</span>
<span style="color:green;">let rec infertype m = function</span>
<span style="color:green;">  | Int (n,_) -&gt; TInt</span>
<span style="color:green;">  | Bool (b,_) -&gt; TBool</span>
<span style="color:green;">  | Op(e1,Plus,e2,_)</span>
<span style="color:green;">    -&gt; (match (infertype m e1, infertype m e2) with</span>
<span style="color:green;">     | (TInt, TInt) -&gt; TInt</span>
<span style="color:green;">     | (TInt, t) -&gt; raise (TypeError (e2, TInt, t))</span>
<span style="color:green;">     | (t,_) -&gt; raise (TypeError (e1, TInt, t)))</span>
<span style="color:green;">  | Op(e1,Mic,e2,_) -&gt; (match (infertype m e1, infertype m e2) with</span>
<span style="color:green;">     | (TInt, TInt) -&gt; TBool</span>
<span style="color:green;">     | (TInt, t) -&gt; raise (TypeError (e2, TInt, t))</span>
<span style="color:green;">     | (t,_) -&gt; raise (TypeError (e1, TInt, t)))</span>
<span style="color:green;">  | If(e1,e2,e3,_) -&gt; (match (infertype m e1, infertype m e2, infertype m e3) with</span>
<span style="color:green;">     | (TBool, t, t') when t=t' -&gt; t</span>
<span style="color:green;">     | (TBool, t, t') -&gt; raise (TypeError (e3, t, t'))</span>
<span style="color:green;">     | (t,_,_) -&gt; raise (TypeError (e1, TBool, t)))</span>
<span style="color:green;">  | Loc (l,loc) -&gt; (try (match lookup l m with TIntRef -&gt; TInt) with </span>
<span style="color:green;">     Not_found -&gt; raise (LocError (l, loc)))</span>
<span style="color:green;">  | Atrib(l,e,loc) -&gt; (try (match (lookup l m, infertype m e) with</span>
<span style="color:green;">     | (TIntRef, TInt) -&gt; TUnit</span>
<span style="color:green;">     | (TIntRef, t) -&gt; raise (TypeError (e, TInt, t))) with</span>
<span style="color:green;">     Not_found -&gt; raise (LocError (l, loc)))</span>
<span style="color:green;">  | Skip _ -&gt; TUnit</span>
<span style="color:green;">  | Secv (e1,e2,_) -&gt; (match (infertype m e1, infertype m e2) with</span>
<span style="color:green;">     | (TUnit,t) -&gt; t</span>
<span style="color:green;">     | (t1,_) -&gt; raise (TypeError (e1, TUnit, t1)))</span>
<span style="color:green;">  | While (e1,e2,_) -&gt; (match (infertype m e1, infertype m e2) with</span>
<span style="color:green;">     | (TBool, TUnit) -&gt; TUnit</span>
<span style="color:green;">     | (TBool, t) -&gt; raise (TypeError (e2, TUnit, t))</span>
<span style="color:green;">     | (t,_) -&gt; raise (TypeError (e1, TBool, t)))</span>


<span style="color:green;">let type_check m e = try</span>
<span style="color:green;">     let _ = infertype m e in true</span>
<span style="color:green;">  with </span>
<span style="color:green;">    | TypeError (e,t1,t2) -&gt; Printf.eprintf &quot;Error: Expected type %s but got type %s at %s.\n&quot;  (string_of_tip t1) (string_of_tip t2) (location e) ; false</span>
<span style="color:green;">    | LocError (l,loc) -&gt; Printf.eprintf &quot;Error: Location %s undefined at %s.\n&quot; l loc ; false</span>


</pre>
</body>
</html>
